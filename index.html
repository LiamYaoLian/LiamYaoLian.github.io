<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"liamyaolian.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Liam Lian&#39;s Blog">
<meta property="og:url" content="https://liamyaolian.github.io/index.html">
<meta property="og:site_name" content="Liam Lian&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Liam Lian">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://liamyaolian.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Liam Lian's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Liam Lian's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/19/MyBatis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/19/MyBatis/" class="post-title-link" itemprop="url">MyBatis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-19 17:12:44" itemprop="dateCreated datePublished" datetime="2022-04-19T17:12:44-04:00">2022-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-20 18:06:01" itemprop="dateModified" datetime="2022-04-20T18:06:01-04:00">2022-04-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><h3 id="Dependency"><a href="#Dependency" class="headerlink" title="Dependency"></a>Dependency</h3><h3 id="mybatis-config-xml"><a href="#mybatis-config-xml" class="headerlink" title="mybatis-config.xml"></a>mybatis-config.xml</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;settings&gt;</span><br><span class="line">        &lt;!-- goods_id ==&gt; goodsId 驼峰命名转换 --&gt;</span><br><span class="line">        &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;!-- 配置SLF4J日志组件 --&gt;</span><br><span class="line">        &lt;setting name=&quot;logImpl&quot; value=&quot;SLF4J&quot;/&gt;</span><br><span class="line">    &lt;/settings&gt;</span><br><span class="line">    &lt;!--启用Pagehelper分页插件--&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;</span><br><span class="line">            &lt;!--设置数据库类型--&gt;</span><br><span class="line">            &lt;property name=&quot;helperDialect&quot; value=&quot;mysql&quot;/&gt;</span><br><span class="line">            &lt;!--分页合理化--&gt;</span><br><span class="line">            &lt;property name=&quot;reasonable&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--设置默认指向的数据库--&gt;</span><br><span class="line">    &lt;environments default=&quot;dev&quot;&gt;</span><br><span class="line">        &lt;!--配置环境，不同的环境不同的id名字--&gt;</span><br><span class="line">        &lt;environment id=&quot;dev&quot;&gt;</span><br><span class="line">            &lt;!-- 采用JDBC方式对数据库事务进行commit/rollback --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!--采用连接池方式管理数据库连接--&gt;</span><br><span class="line">            &lt;!--&lt;dataSource type=&quot;POOLED&quot;&gt;--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;com.ll.mybatis.datasource.C3P0DataSourceFactory&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql://localhost:3306/babytun?useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;user&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;initialPoolSize&quot; value=&quot;5&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;maxPoolSize&quot; value=&quot;20&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;minPoolSize&quot; value=&quot;5&quot;/&gt;</span><br><span class="line">                &lt;!--...--&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">        &lt;environment id=&quot;prd&quot;&gt;</span><br><span class="line">            &lt;!-- 采用JDBC方式对数据库事务进行commit/rollback --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!--采用连接池方式管理数据库连接--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://192.168.1.155:3306/babytun?useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line"></span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;mappers/goods.xml&quot;/&gt;</span><br><span class="line">        &lt;mapper resource=&quot;mappers/goods_detail.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a>Entity</h3><h3 id="Mapper"><a href="#Mapper" class="headerlink" title="Mapper"></a>Mapper</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;goods&quot;&gt;</span><br><span class="line">    &lt;!--开启了二级缓存</span><br><span class="line">        eviction是缓存的清除策略,当缓存对象数量达到上限后,自动触发对应算法对缓存对象清除</span><br><span class="line">            1.LRU – 最近最久未使用:移除最长时间不被使用的对象。</span><br><span class="line">            O1 O2 O3 O4 .. O512</span><br><span class="line">            14 99 83 1     893</span><br><span class="line">            2.FIFO – 先进先出:按对象进入缓存的顺序来移除它们。</span><br><span class="line">            3.SOFT – 软引用:移除基于垃圾收集器状态和软引用规则的对象。</span><br><span class="line">            4.WEAK – 弱引用:更积极的移除基于垃圾收集器状态和弱引用规则的对象。</span><br><span class="line">        flushInterval 间隔多久自动清空缓存，单位毫秒</span><br><span class="line">        size 保存对象或集合（1个集合算一个对象）的上限</span><br><span class="line">        readOnly true代表从缓存取出对象本身，false代表从缓存取出对象的副本</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;cache eviction=&quot;LRU&quot; flushInterval=&quot;600000&quot; size=&quot;512&quot; readOnly=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;select id=&quot;selectAll&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot; useCache=&quot;false&quot;&gt;</span><br><span class="line">        select * from t_goods order by goods_id desc limit 10</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    &lt;!-- 单参数传递,使用parameterType指定参数的数据类型即可,SQL中#&#123;value&#125;提取参数--&gt;</span><br><span class="line">    &lt;select id=&quot;selectById&quot; parameterType=&quot;Integer&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        select * from t_goods where  goods_id = #&#123;value&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 多参数传递时,使用parameterType指定Map接口,SQL中#&#123;key&#125;提取参数 --&gt;</span><br><span class="line">    &lt;select id=&quot;selectByPriceRange&quot; parameterType=&quot;java.util.Map&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        select * from t_goods</span><br><span class="line">        where</span><br><span class="line">          current_price between  #&#123;min&#125; and #&#123;max&#125;</span><br><span class="line">        order by current_price</span><br><span class="line">        limit 0,#&#123;limt&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 利用LinkedHashMap保存多表关联结果</span><br><span class="line">        MyBatis会将每一条记录包装为LinkedHashMap对象</span><br><span class="line">        key是字段名  value是字段对应的值 , 字段类型根据表结构进行自动判断</span><br><span class="line">        优点: 易于扩展,易于使用</span><br><span class="line">        缺点: 太过灵活,无法进行编译时检查</span><br><span class="line">     --&gt;</span><br><span class="line">    &lt;select id=&quot;selectGoodsMap&quot; resultType=&quot;java.util.LinkedHashMap&quot; flushCache=&quot;true&quot;&gt;</span><br><span class="line">        select g.* , c.category_name,&#x27;1&#x27; as test from t_goods g , t_category c</span><br><span class="line">        where g.category_id = c.category_id</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--结果映射--&gt;</span><br><span class="line">    &lt;resultMap id=&quot;rmGoods&quot; type=&quot;com.ll.mybatis.dto.GoodsDTO&quot;&gt;</span><br><span class="line">        &lt;!--设置主键字段与属性映射--&gt;</span><br><span class="line">        &lt;id property=&quot;goods.goodsId&quot; column=&quot;goods_id&quot;&gt;&lt;/id&gt;</span><br><span class="line">        &lt;!--设置非主键字段与属性映射--&gt;</span><br><span class="line">        &lt;result property=&quot;goods.title&quot; column=&quot;title&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;goods.originalCost&quot; column=&quot;original_cost&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;goods.currentPrice&quot; column=&quot;current_price&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;goods.discount&quot; column=&quot;discount&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;goods.isFreeDelivery&quot; column=&quot;is_free_delivery&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;goods.categoryId&quot; column=&quot;category_id&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;category.categoryId&quot; column=&quot;category_id&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;category.categoryName&quot; column=&quot;category_name&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;category.parentId&quot; column=&quot;parent_id&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;category.categoryLevel&quot; column=&quot;category_level&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;category.categoryOrder&quot; column=&quot;category_order&quot;&gt;&lt;/result&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;result property=&quot;test&quot; column=&quot;test&quot;/&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line">    &lt;select id=&quot;selectGoodsDTO&quot; resultMap=&quot;rmGoods&quot;&gt;</span><br><span class="line">        select g.* , c.*,&#x27;1&#x27; as test from t_goods g , t_category c</span><br><span class="line">        where g.category_id = c.category_id</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    &lt;!--flushCache=&quot;true&quot;在sql执行后强制清空缓存--&gt;</span><br><span class="line">    &lt;insert id=&quot;insert&quot; parameterType=&quot;com.ll.mybatis.entity.Goods&quot; flushCache=&quot;true&quot;&gt;</span><br><span class="line">        INSERT INTO t_goods(title, sub_title, original_cost, current_price, discount, is_free_delivery, category_id)</span><br><span class="line">        VALUES (#&#123;title&#125; , #&#123;subTitle&#125; , #&#123;originalCost&#125;, #&#123;currentPrice&#125;, #&#123;discount&#125;, #&#123;isFreeDelivery&#125;, #&#123;categoryId&#125;)</span><br><span class="line">      &lt;!--&lt;selectKey resultType=&quot;Integer&quot; keyProperty=&quot;goodsId&quot; order=&quot;AFTER&quot;&gt;--&gt;</span><br><span class="line">          &lt;!--select last_insert_id()--&gt;</span><br><span class="line">      &lt;!--&lt;/selectKey&gt;--&gt;</span><br><span class="line">      &lt;!--selectKey applies to all relational databases; useGeneratedKeys applies to databases that support auto increment PK--&gt;</span><br><span class="line">      &lt;!--Oracle: doesn&#x27;t have auto increment PK--&gt;</span><br><span class="line">      &lt;!--&lt;selectKey resultType=&quot;Integer&quot; keyProperty=&quot;goodsId&quot; order=&quot;BEFORE&quot;&gt;--&gt;</span><br><span class="line">          &lt;!--select seq_goods.nextval as id from dual--&gt;</span><br><span class="line">      &lt;!--&lt;/selectKey&gt;--&gt;</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line">    &lt;update id=&quot;update&quot; parameterType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        UPDATE t_goods</span><br><span class="line">        SET</span><br><span class="line">          title = #&#123;title&#125; ,</span><br><span class="line">          sub_title = #&#123;subTitle&#125; ,</span><br><span class="line">          original_cost = #&#123;originalCost&#125; ,</span><br><span class="line">          current_price = #&#123;currentPrice&#125; ,</span><br><span class="line">          discount = #&#123;discount&#125; ,</span><br><span class="line">          is_free_delivery = #&#123;isFreeDelivery&#125; ,</span><br><span class="line">          category_id = #&#123;categoryId&#125;</span><br><span class="line">        WHERE</span><br><span class="line">          goods_id = #&#123;goodsId&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">    &lt;!--delete from t_goods where goods_id in (1920,1921)--&gt;</span><br><span class="line">    &lt;delete id=&quot;delete&quot; parameterType=&quot;Integer&quot;&gt;</span><br><span class="line">        delete from t_goods where goods_id = #&#123;value&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=&quot;selectByTitle&quot; parameterType=&quot;java.util.Map&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        select * from t_goods where title = #&#123;title&#125;</span><br><span class="line">        $&#123;order&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=&quot;dynamicSQL&quot; parameterType=&quot;java.util.Map&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        select * from t_goods</span><br><span class="line">        &lt;where&gt;</span><br><span class="line">          &lt;if test=&quot;categoryId != null&quot;&gt;</span><br><span class="line">              and category_id = #&#123;categoryId&#125;</span><br><span class="line">          &lt;/if&gt;</span><br><span class="line">          &lt;if test=&quot;currentPrice != null&quot;&gt;</span><br><span class="line">              and current_price &amp;lt; #&#123;currentPrice&#125;</span><br><span class="line">          &lt;/if&gt;</span><br><span class="line">        &lt;/where&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">        resultMap可用于说明一对多或者多对一的映射逻辑</span><br><span class="line">        id 是resultMap属性引用的标志</span><br><span class="line">        type 指向One的实体(Goods)</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;resultMap id=&quot;rmGoods1&quot; type=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        &lt;!-- 映射goods对象的主键到goods_id字段 --&gt;</span><br><span class="line">        &lt;id column=&quot;goods_id&quot; property=&quot;goodsId&quot;&gt;&lt;/id&gt;</span><br><span class="line">        &lt;!--</span><br><span class="line">            collection的含义是,在</span><br><span class="line">            select * from t_goods limit 0,1 得到结果后,对所有Goods对象遍历得到goods_id字段值,</span><br><span class="line">            并代入到goodsDetail命名空间的findByGoodsId的SQL中执行查询,</span><br><span class="line">            将得到的&quot;商品详情&quot;集合赋值给goodsDetails List对象.</span><br><span class="line">        --&gt;</span><br><span class="line">        &lt;collection property=&quot;goodsDetails&quot; select=&quot;goodsDetail.selectByGoodsId&quot;</span><br><span class="line">                    column=&quot;goods_id&quot;/&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line">    &lt;select id=&quot;selectOneToMany&quot; resultMap=&quot;rmGoods1&quot;&gt;</span><br><span class="line">        select * from t_goods limit 0,10</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=&quot;selectPage&quot; resultType=&quot;com.ll.mybatis.entity.Goods&quot;&gt;</span><br><span class="line">        select * from t_goods where current_price &amp;lt; 1000</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--INSERT INTO table--&gt;</span><br><span class="line">    &lt;!--VALUES (&quot;a&quot; , &quot;a1&quot; , &quot;a2&quot;),(&quot;b&quot; , &quot;b1&quot; , &quot;b2&quot;),(....)--&gt;</span><br><span class="line">    &lt;!--Pro: faster than inserting one. --&gt;</span><br><span class="line">    &lt;!--limitation: 1. cannot get the id of the inserted row. 2. If the SQL query is too long, the server may reject it. Need stress test. --&gt;</span><br><span class="line">    &lt;insert id=&quot;batchInsert&quot; parameterType=&quot;java.util.List&quot;&gt;</span><br><span class="line">        INSERT INTO t_goods(title, sub_title, original_cost, current_price, discount, is_free_delivery, category_id)</span><br><span class="line">        VALUES</span><br><span class="line">        &lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">            (#&#123;item.title&#125;,#&#123;item.subTitle&#125;, #&#123;item.originalCost&#125;, #&#123;item.currentPrice&#125;, #&#123;item.discount&#125;, #&#123;item.isFreeDelivery&#125;, #&#123;item.categoryId&#125;)</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">    &lt;!--in (1901,1902)--&gt;</span><br><span class="line">    &lt;delete id=&quot;batchDelete&quot; parameterType=&quot;java.util.List&quot;&gt;</span><br><span class="line">        DELETE FROM t_goods WHERE goods_id in</span><br><span class="line">        &lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; open=&quot;(&quot; close=&quot;)&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">            #&#123;item&#125;</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;goodsDetail&quot;&gt;</span><br><span class="line">    &lt;select id=&quot;selectByGoodsId&quot; parameterType=&quot;Integer&quot;</span><br><span class="line">            resultType=&quot;com.ll.mybatis.entity.GoodsDetail&quot;&gt;</span><br><span class="line">        select * from t_goods_detail where goods_id = #&#123;value&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;resultMap id=&quot;rmGoodsDetail&quot; type=&quot;com.ll.mybatis.entity.GoodsDetail&quot;&gt;</span><br><span class="line">        &lt;id column=&quot;gd_id&quot; property=&quot;gdId&quot;/&gt;</span><br><span class="line">        &lt;result column=&quot;goods_id&quot; property=&quot;goodsId&quot;/&gt;</span><br><span class="line">        &lt;association property=&quot;goods&quot; select=&quot;goods.selectById&quot; column=&quot;goods_id&quot;&gt;&lt;/association&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line">    &lt;select id=&quot;selectManyToOne&quot; resultMap=&quot;rmGoodsDetail&quot;&gt;</span><br><span class="line">        select * from t_goods_detail limit 0,20</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<h3 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h3><ul>
<li>a Mybatis class used to initialize MyBatis and create SqlSession objects</li>
<li>Singleton</li>
<li>SqlSession uses JDBC<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.Reader;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * MyBatisUtils工具类,创建全局唯一的SqlSessionFactory对象</span><br><span class="line"> */</span><br><span class="line">public class MyBatisUtils &#123;</span><br><span class="line">    //利用static(静态)属于类不属于对象,且全局唯一</span><br><span class="line">    private static SqlSessionFactory sqlSessionFactory = null;</span><br><span class="line">    //利用静态块在初始化类时实例化sqlSessionFactory</span><br><span class="line">    static &#123;</span><br><span class="line">        Reader reader = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            reader = Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;);</span><br><span class="line">            sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            //初始化错误时,通过抛出异常ExceptionInInitializerError通知调用者</span><br><span class="line">            throw new ExceptionInInitializerError(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * openSession 创建一个新的SqlSession对象</span><br><span class="line">     * @return SqlSession对象</span><br><span class="line">     */</span><br><span class="line">    public static SqlSession openSession()&#123;</span><br><span class="line">        return sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 释放一个有效的SqlSession对象</span><br><span class="line">     * @param session 准备释放SqlSession对象</span><br><span class="line">     */</span><br><span class="line">    public static void closeSession(SqlSession session)&#123;</span><br><span class="line">        if(session != null)&#123;</span><br><span class="line">            session.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Manipulate-using-SqlSession"><a href="#Manipulate-using-SqlSession" class="headerlink" title="Manipulate using SqlSession"></a>Manipulate using SqlSession</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br></pre></td><td class="code"><pre><span class="line">package com.ll.mybatis;</span><br><span class="line"></span><br><span class="line">import com.github.pagehelper.Page;</span><br><span class="line">import com.github.pagehelper.PageHelper;</span><br><span class="line">import com.ll.mybatis.dto.GoodsDTO;</span><br><span class="line">import com.ll.mybatis.entity.Goods;</span><br><span class="line">import com.ll.mybatis.entity.GoodsDetail;</span><br><span class="line">import com.ll.mybatis.utils.MyBatisUtils;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.Reader;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">//JUNIT单元测试类</span><br><span class="line">public class MyBatisTestor &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 初始化SqlSessionFactory</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSqlSessionFactory() throws IOException &#123;</span><br><span class="line">        //利用Reader加载classpath下的mybatis-config.xml核心配置文件</span><br><span class="line">        Reader reader = Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;);</span><br><span class="line">        //初始化SqlSessionFactory对象,同时解析mybatis-config.xml文件</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader);</span><br><span class="line">        System.out.println(&quot;SessionFactory加载成功&quot;);</span><br><span class="line">        SqlSession sqlSession = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            //创建SqlSession对象,SqlSession是JDBC的扩展类,用于与数据库交互</span><br><span class="line">            sqlSession = sqlSessionFactory.openSession();</span><br><span class="line">            //创建数据库连接(测试用)</span><br><span class="line">            Connection connection = sqlSession.getConnection();</span><br><span class="line">            System.out.println(connection);</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (sqlSession != null)&#123;</span><br><span class="line">                //如果type=&quot;POOLED&quot;,代表使用连接池,close则是将连接回收到连接池中</span><br><span class="line">                //如果type=&quot;UNPOOLED&quot;,代表直连,close则会调用Connection.close()方法关闭连接</span><br><span class="line">                sqlSession.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * MyBatisUtils使用指南</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testMyBatisUtils() throws Exception &#123;</span><br><span class="line">        SqlSession sqlSession = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            sqlSession = MyBatisUtils.openSession();</span><br><span class="line">            Connection connection = sqlSession.getConnection();</span><br><span class="line">            System.out.println(connection);</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(sqlSession);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * select查询语句执行</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectAll() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List&lt;Goods&gt; list = session.selectList(&quot;goods.selectAll&quot;);</span><br><span class="line">            for(Goods g : list)&#123;</span><br><span class="line">                System.out.println(g.getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 传递单个SQL参数</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectById() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            System.out.println(goods.getTitle());</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 传递多个SQL参数</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectByPriceRange() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Map param = new HashMap();</span><br><span class="line">            param.put(&quot;min&quot;,100);</span><br><span class="line">            param.put(&quot;max&quot; , 500);</span><br><span class="line">            param.put(&quot;limt&quot; , 10);</span><br><span class="line">            List&lt;Goods&gt; list = session.selectList(&quot;goods.selectByPriceRange&quot;, param);</span><br><span class="line">            for(Goods g:list)&#123;</span><br><span class="line">                System.out.println(g.getTitle() + &quot;:&quot; + g.getCurrentPrice());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 利用Map接收关联查询结果</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectGoodsMap() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List&lt;Map&gt; list = session.selectList(&quot;goods.selectGoodsMap&quot;);</span><br><span class="line">            for(Map map : list)&#123;</span><br><span class="line">                System.out.println(map);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 利用ResultMap进行结果映射</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectGoodsDTO() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List&lt;GoodsDTO&gt; list = session.selectList(&quot;goods.selectGoodsDTO&quot;);</span><br><span class="line">            for (GoodsDTO g : list) &#123;</span><br><span class="line">                System.out.println(g.getGoods().getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增数据</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testInsert() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = new Goods();</span><br><span class="line">            goods.setTitle(&quot;测试商品&quot;);</span><br><span class="line">            goods.setSubTitle(&quot;测试子标题&quot;);</span><br><span class="line">            goods.setOriginalCost(200f);</span><br><span class="line">            goods.setCurrentPrice(100f);</span><br><span class="line">            goods.setDiscount(0.5f);</span><br><span class="line">            goods.setIsFreeDelivery(1);</span><br><span class="line">            goods.setCategoryId(43);</span><br><span class="line">            //insert()方法返回值代表本次成功插入的记录总数</span><br><span class="line">            int num = session.insert(&quot;goods.insert&quot;, goods);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">            System.out.println(goods.getGoodsId());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            if(session != null)&#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 更新数据</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testUpdate() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot;, 739);</span><br><span class="line">            goods.setTitle(&quot;更新测试商品&quot;);</span><br><span class="line">            int num = session.update(&quot;goods.update&quot; , goods);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            if(session != null)&#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除数据</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testDelete() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            int num = session.delete(&quot;goods.delete&quot; , 739);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            if(session != null)&#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 预防SQL注入</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectByTitle() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Map param = new HashMap();</span><br><span class="line">            /*</span><br><span class="line">                $&#123;&#125;原文传值</span><br><span class="line">                select * from t_goods</span><br><span class="line">                where title = &#x27;&#x27; or 1 =1 or title = &#x27;【德国】爱他美婴幼儿配方奶粉1段800g*2罐 铂金版&#x27;</span><br><span class="line">            */</span><br><span class="line">            /*</span><br><span class="line">               #&#123;&#125;预编译</span><br><span class="line">               select * from t_goods</span><br><span class="line">                where title = &quot;&#x27;&#x27; or 1 =1 or title = &#x27;【德国】爱他美婴幼儿配方奶粉1段800g*2罐 铂金版&#x27;&quot;</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line">            param.put(&quot;title&quot;,&quot;&#x27;&#x27; or 1=1 or title=&#x27;【德国】爱他美婴幼儿配方奶粉1段800g*2罐 铂金版&#x27;&quot;);</span><br><span class="line">            param.put(&quot;order&quot; , &quot; order by title desc&quot;);</span><br><span class="line">            List&lt;Goods&gt; list = session.selectList(&quot;goods.selectByTitle&quot;, param);</span><br><span class="line">            for(Goods g:list)&#123;</span><br><span class="line">                System.out.println(g.getTitle() + &quot;:&quot; + g.getCurrentPrice());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 动态SQL语句</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testDynamicSQL() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Map param = new HashMap();</span><br><span class="line">            param.put(&quot;categoryId&quot;, 44);</span><br><span class="line">            param.put(&quot;currentPrice&quot;, 500);</span><br><span class="line">            //查询条件</span><br><span class="line">            List&lt;Goods&gt; list = session.selectList(&quot;goods.dynamicSQL&quot;, param);</span><br><span class="line">            for(Goods g:list)&#123;</span><br><span class="line">                System.out.println(g.getTitle() + &quot;:&quot; +</span><br><span class="line">                        g.getCategoryId()  + &quot;:&quot; + g.getCurrentPrice());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试一级缓存</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testLv1Cache() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            Goods goods1 = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            System.out.println(goods.hashCode() + &quot;:&quot; + goods1.hashCode());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            session.commit();//commit提交时对该namespace缓存强制清空</span><br><span class="line">            Goods goods1 = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            System.out.println(goods.hashCode() + &quot;:&quot; + goods1.hashCode());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试二级缓存</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testLv2Cache() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            System.out.println(goods.hashCode());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = session.selectOne(&quot;goods.selectById&quot; , 1603);</span><br><span class="line">            System.out.println(goods.hashCode());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 一对多对象关联查询</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testOneToMany() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List&lt;Goods&gt; list = session.selectList(&quot;goods.selectOneToMany&quot;);</span><br><span class="line">            for(Goods goods:list) &#123;</span><br><span class="line">                System.out.println(goods.getTitle() + &quot;:&quot; + goods.getGoodsDetails().size());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试多对一对象关联映射</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testManyToOne() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List&lt;GoodsDetail&gt; list = session.selectList(&quot;goodsDetail.selectManyToOne&quot;);</span><br><span class="line">            for(GoodsDetail gd:list) &#123;</span><br><span class="line">                System.out.println(gd.getGdPicUrl() + &quot;:&quot; + gd.getGoods().getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    /**</span><br><span class="line">     * PageHelper分页查询</span><br><span class="line">     */</span><br><span class="line">    public void testSelectPage() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            /*startPage方法会自动将下一次查询进行分页*/</span><br><span class="line">            PageHelper.startPage(2,10);</span><br><span class="line">            Page&lt;Goods&gt; page = (Page) session.selectList(&quot;goods.selectPage&quot;);</span><br><span class="line">            System.out.println(&quot;总页数:&quot; + page.getPages());</span><br><span class="line">            System.out.println(&quot;总记录数:&quot; + page.getTotal());</span><br><span class="line">            System.out.println(&quot;开始行号:&quot; + page.getStartRow());</span><br><span class="line">            System.out.println(&quot;结束行号:&quot; + page.getEndRow());</span><br><span class="line">            System.out.println(&quot;当前页码:&quot; + page.getPageNum());</span><br><span class="line">            List&lt;Goods&gt; data = page.getResult();//当前页数据</span><br><span class="line">            for (Goods g : data) &#123;</span><br><span class="line">                System.out.println(g.getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(&quot;&quot;);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 批量插入测试</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testBatchInsert() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            long st = new Date().getTime();</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List list = new ArrayList();</span><br><span class="line">            for (int i = 0; i &lt; 10000; i++) &#123;</span><br><span class="line">                Goods goods = new Goods();</span><br><span class="line">                goods.setTitle(&quot;测试商品&quot;);</span><br><span class="line">                goods.setSubTitle(&quot;测试子标题&quot;);</span><br><span class="line">                goods.setOriginalCost(200f);</span><br><span class="line">                goods.setCurrentPrice(100f);</span><br><span class="line">                goods.setDiscount(0.5f);</span><br><span class="line">                goods.setIsFreeDelivery(1);</span><br><span class="line">                goods.setCategoryId(43);</span><br><span class="line">                //insert()方法返回值代表本次成功插入的记录总数</span><br><span class="line"></span><br><span class="line">                list.add(goods);</span><br><span class="line">            &#125;</span><br><span class="line">            session.insert(&quot;goods.batchInsert&quot;, list);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">            long et = new Date().getTime();</span><br><span class="line">            System.out.println(&quot;执行时间:&quot; + (et - st) + &quot;毫秒&quot;);</span><br><span class="line">//            System.out.println(goods.getGoodsId());</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            if (session != null) &#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 10000次数据插入对比测试用例</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testInsert1() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            long st = new Date().getTime();</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List list = new ArrayList();</span><br><span class="line">            for(int i = 0 ; i &lt; 10000 ; i++) &#123;</span><br><span class="line">                Goods goods = new Goods();</span><br><span class="line">                goods.setTitle(&quot;测试商品&quot;);</span><br><span class="line">                goods.setSubTitle(&quot;测试子标题&quot;);</span><br><span class="line">                goods.setOriginalCost(200f);</span><br><span class="line">                goods.setCurrentPrice(100f);</span><br><span class="line">                goods.setDiscount(0.5f);</span><br><span class="line">                goods.setIsFreeDelivery(1);</span><br><span class="line">                goods.setCategoryId(43);</span><br><span class="line">                //insert()方法返回值代表本次成功插入的记录总数</span><br><span class="line"></span><br><span class="line">                session.insert(&quot;goods.insert&quot; , goods);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">            long et = new Date().getTime();</span><br><span class="line">            System.out.println(&quot;执行时间:&quot; + (et-st) + &quot;毫秒&quot;);</span><br><span class="line">//            System.out.println(goods.getGoodsId());</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            if(session != null)&#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 批量删除测试</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testBatchDelete() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            long st = new Date().getTime();</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            List list = new ArrayList();</span><br><span class="line">            list.add(1920);</span><br><span class="line">            list.add(1921);</span><br><span class="line">            list.add(1922);</span><br><span class="line">            session.delete(&quot;goods.batchDelete&quot;, list);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">            long et = new Date().getTime();</span><br><span class="line">            System.out.println(&quot;执行时间:&quot; + (et - st) + &quot;毫秒&quot;);</span><br><span class="line">//            System.out.println(goods.getGoodsId());</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            if (session != null) &#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="vs"><a href="#vs" class="headerlink" title="${} vs #{}"></a>${} vs #{}</h2></li>
<li>${}: if use this, cannot allow the front end to input the value. Should use pre-set values to prevent SQL injection.</li>
<li>#{}: precompilation to prevent SQL injection</li>
</ul>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>logback.xml<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">   &lt;appender name=&quot;console&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;</span><br><span class="line">       &lt;encoder&gt;</span><br><span class="line">           &lt;pattern&gt;[%thread] %d&#123;HH:mm:ss.SSS&#125; %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt;</span><br><span class="line">       &lt;/encoder&gt;</span><br><span class="line">   &lt;/appender&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">        日志输出级别(优先级高到低):</span><br><span class="line">        error: 错误 - 系统的故障日志</span><br><span class="line">        warn: 警告 - 存在风险或使用不当的日志</span><br><span class="line">        info: 一般性消息 // &quot;info&quot; and above are used in production environtment</span><br><span class="line">        debug: 程序内部用于调试信息 // &quot;debug&quot; and above are used in development environment</span><br><span class="line">        trace: 程序运行的跟踪信息</span><br><span class="line">     --&gt;</span><br><span class="line">    &lt;root level=&quot;debug&quot;&gt;</span><br><span class="line">        &lt;appender-ref ref=&quot;console&quot;/&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h2><ul>
<li>一级缓存默认开启,缓存范围SqlSession会话</li>
<li>二级缓存手动开启,属于范围Mapper Namespace</li>
<li>Namespace includes SqlSessions</li>
<li>写操作commit提交时对该namespace或SqlSession缓存强制清空</li>
<li>配置useCache&#x3D;false可以不用缓存</li>
<li>配置flushCache&#x3D;true代表强制清空缓存</li>
</ul>
<h2 id="PageHelper"><a href="#PageHelper" class="headerlink" title="PageHelper"></a>PageHelper</h2><ul>
<li><p>maven引入PageHelper与jsqlparser</p>
</li>
<li><p>mybatis-config.xml增加Plugin配置</p>
</li>
<li><p>代码中使用PageHelper.startPage()自动分页</p>
</li>
<li><p>MySQL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from table limit 10,20;</span><br></pre></td></tr></table></figure></li>
<li><p>Oracle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select t3.* from (</span><br><span class="line">  select t2.*, rownum as row_num from (</span><br><span class="line">    select * from table order by id asc</span><br><span class="line">  ) t2 where rownum&lt;=20</span><br><span class="line">) t3</span><br><span class="line">where t2.row_num&gt;11</span><br></pre></td></tr></table></figure></li>
<li><p>SQL Server 2000</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select top 3 * from table</span><br><span class="line">where</span><br><span class="line">id not in</span><br><span class="line">(select top 15 id from table)</span><br></pre></td></tr></table></figure></li>
<li><p>SQL Server 2012+</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from table order by id</span><br><span class="line">offset 4 rows fetch next 5 rows only</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="C3P0"><a href="#C3P0" class="headerlink" title="C3P0"></a>C3P0</h2><ul>
<li>dependency</li>
<li>C3P0DataSourceFactory<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.ll.mybatis.datasource;</span><br><span class="line"></span><br><span class="line">import com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line">import org.apache.ibatis.datasource.unpooled.UnpooledDataSourceFactory;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * C3P0与MyBatis兼容使用的数据源工厂类</span><br><span class="line"> */</span><br><span class="line">public class C3P0DataSourceFactory extends UnpooledDataSourceFactory &#123;</span><br><span class="line">    public C3P0DataSourceFactory()&#123;</span><br><span class="line">        this.dataSource = new ComboPooledDataSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>mybatis-config.xml</li>
</ul>
<h2 id="Annotation"><a href="#Annotation" class="headerlink" title="Annotation"></a>Annotation</h2><ul>
<li><code>@Insert</code></li>
<li><code>@Update</code></li>
<li><code>@Delete</code></li>
<li><code>@Select</code></li>
<li><code>@Param</code> 参数映射</li>
<li><code>@Results</code> <resultMap> 结果映射</li>
<li><code>@Result</code><id><result> 字段映射<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.ll.mybatis.dao;</span><br><span class="line"></span><br><span class="line">import com.ll.mybatis.dto.GoodsDTO;</span><br><span class="line">import com.ll.mybatis.entity.Goods;</span><br><span class="line">import org.apache.ibatis.annotations.*;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public interface GoodsDAO &#123;</span><br><span class="line">    @Select(&quot;select * from t_goods where current_price between  #&#123;min&#125; and #&#123;max&#125; order by current_price limit 0,#&#123;limt&#125;&quot;)</span><br><span class="line">    public List&lt;Goods&gt; selectByPriceRange(@Param(&quot;min&quot;) Float min ,@Param(&quot;max&quot;) Float max ,@Param(&quot;limt&quot;) Integer limt);</span><br><span class="line"></span><br><span class="line">    @Insert(&quot;INSERT INTO t_goods(title, sub_title, original_cost, current_price, discount, is_free_delivery, category_id) VALUES (#&#123;title&#125; , #&#123;subTitle&#125; , #&#123;originalCost&#125;, #&#123;currentPrice&#125;, #&#123;discount&#125;, #&#123;isFreeDelivery&#125;, #&#123;categoryId&#125;)&quot;)</span><br><span class="line">    //&lt;selectKey&gt;</span><br><span class="line">    @SelectKey(statement = &quot;select last_insert_id()&quot; , before = false , keyProperty = &quot;goodsId&quot; , resultType = Integer.class)</span><br><span class="line">    public int insert(Goods goods);</span><br><span class="line"></span><br><span class="line">    @Select(&quot;select * from t_goods&quot;)</span><br><span class="line">    //&lt;resultMap&gt;</span><br><span class="line">    @Results(&#123;</span><br><span class="line">            //&lt;id&gt;</span><br><span class="line">          @Result(column = &quot;goods_id&quot; ,property = &quot;goodsId&quot; , id = true) ,</span><br><span class="line">            //&lt;result&gt;</span><br><span class="line">            @Result(column = &quot;title&quot; ,property = &quot;title&quot;),</span><br><span class="line">            @Result(column = &quot;current_price&quot; ,property = &quot;currentPrice&quot;)</span><br><span class="line">    &#125;)</span><br><span class="line">    public List&lt;GoodsDTO&gt; selectAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;settings&gt;</span><br><span class="line">        &lt;!-- goods_id ==&gt; goodsId 驼峰命名转换 --&gt;</span><br><span class="line">        &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;/settings&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--设置默认指向的数据库--&gt;</span><br><span class="line">    &lt;environments default=&quot;dev&quot;&gt;</span><br><span class="line">        &lt;!--配置环境，不同的环境不同的id名字--&gt;</span><br><span class="line">        &lt;environment id=&quot;dev&quot;&gt;</span><br><span class="line">            &lt;!-- 采用JDBC方式对数据库事务进行commit/rollback --&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!--采用连接池方式管理数据库连接--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/babytun?useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;!--&lt;mapper class=&quot;com.ll.mybatis.dao.GoodsDAO&quot;/&gt;--&gt;</span><br><span class="line">        &lt;package name=&quot;com.ll.mybatis.dao&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">package com.ll.mybatis;</span><br><span class="line"></span><br><span class="line">import com.ll.mybatis.dao.GoodsDAO;</span><br><span class="line">import com.ll.mybatis.dto.GoodsDTO;</span><br><span class="line">import com.ll.mybatis.entity.Goods;</span><br><span class="line">import com.ll.mybatis.utils.MyBatisUtils;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">//JUNIT单元测试类</span><br><span class="line">public class MyBatisTestor &#123;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectByPriceRange() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            GoodsDAO goodsDAO = session.getMapper(GoodsDAO.class);</span><br><span class="line">            List&lt;Goods&gt; list = goodsDAO.selectByPriceRange(100f, 500f, 20);</span><br><span class="line">            System.out.println(list.size());</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增数据</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testInsert() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            Goods goods = new Goods();</span><br><span class="line">            goods.setTitle(&quot;测试商品&quot;);</span><br><span class="line">            goods.setSubTitle(&quot;测试子标题&quot;);</span><br><span class="line">            goods.setOriginalCost(200f);</span><br><span class="line">            goods.setCurrentPrice(100f);</span><br><span class="line">            goods.setDiscount(0.5f);</span><br><span class="line">            goods.setIsFreeDelivery(1);</span><br><span class="line">            goods.setCategoryId(43);</span><br><span class="line">            GoodsDAO goodsDAO = session.getMapper(GoodsDAO.class);</span><br><span class="line">            //insert()方法返回值代表本次成功插入的记录总数</span><br><span class="line">            int num = goodsDAO.insert(goods);</span><br><span class="line">            session.commit();//提交事务数据</span><br><span class="line">            System.out.println(goods.getGoodsId());</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            if(session != null)&#123;</span><br><span class="line">                session.rollback();//回滚事务</span><br><span class="line">            &#125;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testSelectAll() throws Exception &#123;</span><br><span class="line">        SqlSession session = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            session = MyBatisUtils.openSession();</span><br><span class="line">            GoodsDAO goodsDAO = session.getMapper(GoodsDAO.class);</span><br><span class="line">            List&lt;GoodsDTO&gt; list = goodsDAO.selectAll();</span><br><span class="line">            System.out.println(list.size());</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            MyBatisUtils.closeSession(session);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/19/jQuery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/19/jQuery/" class="post-title-link" itemprop="url">jQuery</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-04-19 16:46:32 / Modified: 17:09:40" itemprop="dateCreated datePublished" datetime="2022-04-19T16:46:32-04:00">2022-04-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><ul>
<li><p>jQuery(选择器表达式)</p>
</li>
<li><p>$(选择器表达式)</p>
</li>
<li><p>“*”: all</p>
</li>
<li><p>$(“#id”)</p>
</li>
<li><p>$(“标签”)</p>
</li>
<li><p>$(“.class”)</p>
</li>
<li><p>$(“S1, S2, SN”): 组合</p>
</li>
<li><p>$(“ancestor descendant”): 后代</p>
</li>
<li><p>$(“ancestor&gt;descendant”): 子</p>
</li>
<li><p>$(“prev~siblings”): 兄弟</p>
</li>
<li><p>$(“selector[attribute&#x3D;value]”)</p>
</li>
<li><p>$(“selector[attribute^&#x3D;value]”): 以某值开头</p>
</li>
<li><p>$(“selector[attribute$&#x3D;value]”): 以某值结尾</p>
</li>
<li><p>$(“selector[attribute*&#x3D;value]”): 包含某值</p>
</li>
<li><p>$(“selector:first”)</p>
</li>
<li><p>$(“selector:last”)</p>
</li>
<li><p>$(“selector:even”)</p>
</li>
<li><p>$(“selector:odd”)</p>
</li>
<li><p>$(“selector:eq(n)”)</p>
</li>
<li><p>$(“selector:input”)</p>
</li>
<li><p>$(“selector:text”)</p>
</li>
<li><p>$(“selector:password”)</p>
</li>
<li><p>$(“selector:submit”)</p>
</li>
<li><p>$(“selector:reset”)</p>
</li>
<li><p>attr(name|properties|key): 获取或设置元素属性</p>
</li>
<li><p>removeAttr(name)</p>
</li>
<li><p>css(): 获取或设置匹配元素的样式属性</p>
</li>
<li><p>addClass()</p>
</li>
<li><p>removeClass()</p>
</li>
<li><p>val() - 获取或设置输入项的值</p>
</li>
<li><p>text() - 获取或设置元素的纯文本</p>
</li>
<li><p>html() - 获取或设置元素内部的HTML</p>
</li>
<li><p>on(“click” , function) - 为选中的页面元素绑定单击事件</p>
</li>
<li><p>click(function) - 是绑定事件的简写形式</p>
</li>
</ul>
<h2 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h2><h3 id="Mouse"><a href="#Mouse" class="headerlink" title="Mouse"></a>Mouse</h3><ul>
<li>click   </li>
<li>dblclick   </li>
<li>mouseenter   </li>
<li>mouseleave  </li>
<li>mouseover<h3 id="Keyboard"><a href="#Keyboard" class="headerlink" title="Keyboard"></a>Keyboard</h3></li>
<li>keypress</li>
<li>keydown</li>
<li>keyup<h3 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h3></li>
<li>submit</li>
<li>change</li>
<li>focus<h3 id="Document-x2F-Window"><a href="#Document-x2F-Window" class="headerlink" title="Document &#x2F; Window"></a>Document &#x2F; Window</h3></li>
<li>load</li>
<li>resize</li>
<li>scroll</li>
<li>unload</li>
</ul>
<h2 id="Ready"><a href="#Ready" class="headerlink" title="Ready"></a>Ready</h2><ul>
<li>$(document).ready(function)</li>
<li>$(function)</li>
</ul>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><ul>
<li>Asynchronous JavaScript And XML</li>
<li>allow to update some without refreshing<h3 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h3></li>
<li>create XmlHttpReqeust object<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var xmlhttp;</span><br><span class="line">if (window.XMLHttpRequest)</span><br><span class="line">&#123;</span><br><span class="line">// IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码</span><br><span class="line">xmlhttp=new XMLHttpRequest();</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">// IE6, IE5 浏览器执行代码</span><br><span class="line">xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>send Ajax request<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//创建请求</span><br><span class="line">xmlhttp.open(&quot;GET&quot;,&quot;http://localhost/test?name=admin&quot;,true);</span><br><span class="line">//发送到服务器</span><br><span class="line">xmlhttp.send();</span><br></pre></td></tr></table></figure></li>
<li>deals with response<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.onreadystatechange=function()</span><br><span class="line">&#123;</span><br><span class="line">//响应已被接收且服务器处理成功时才执行</span><br><span class="line">if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)</span><br><span class="line">&#123;</span><br><span class="line">//获取响应体的文本</span><br><span class="line">var responseText = xmlhttp.responseText;</span><br><span class="line">//对服务器结果进行处理</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="jQuery-supports-Ajax"><a href="#jQuery-supports-Ajax" class="headerlink" title="jQuery supports Ajax"></a>jQuery supports Ajax</h2><p>url 发送请求地址<br>type 请求类型<br>get | post<br>data 向服务器传递的参数<br>dataType 服务器响应的数据类型<br>text | json | xml | html | jsonp| script<br>success 接收响应时的处理函数<br>error 请求失败时的处理函数</p>
<h2 id="从ajax方法衍生的简化方法"><a href="#从ajax方法衍生的简化方法" class="headerlink" title="从ajax方法衍生的简化方法"></a>从ajax方法衍生的简化方法</h2><p>$.get() 发送Get方式Ajax请求<br>$.post() 发送Post方式Ajax请求<br>$.ajaxSetup() 设置Ajax全局默认值</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/17/Java-Web/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/17/Java-Web/" class="post-title-link" itemprop="url">Java Web</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-17 19:23:29" itemprop="dateCreated datePublished" datetime="2022-04-17T19:23:29-04:00">2022-04-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-19 16:42:38" itemprop="dateModified" datetime="2022-04-19T16:42:38-04:00">2022-04-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><ul>
<li>Extensible Markup Language, has tags, to save and transfer data or config<h3 id="markup"><a href="#markup" class="headerlink" title="markup"></a>markup</h3></li>
<li>lower case, “-“</li>
<li>no duplicate names in different layers</li>
<li>&amp;lt, &amp;gt, &amp;amp, &amp;apos, &amp;quot<h3 id="cdata"><a href="#cdata" class="headerlink" title="cdata"></a>cdata</h3></li>
<li>element content that parser to interpret as character data, not markup</li>
<li><code>&lt;![CDATA[ content here ]]&gt;</code><h3 id="Semantic-constraint"><a href="#Semantic-constraint" class="headerlink" title="Semantic constraint"></a>Semantic constraint</h3><h4 id="dtd"><a href="#dtd" class="headerlink" title="dtd"></a>dtd</h4></li>
<li><!ELEMENT>: to define what elements and how many are allowed<ul>
<li><!ELEMENT hr (employee) >: one “employee” node under the “hr” node</li>
<li><!ELEMENT hr (employee+) >: at least one “employee” node under the “hr” node</li>
<li><!ELEMENT hr (employee*) >: can have 0 to n “employee” nodes under the “hr” node</li>
<li><!ELEMENT hr (employee?) >: at most one “employee” node under the “hr” node</li>
<li><!ELEMENT employee (name, age, salary, department)>: must have four nodes with this order</li>
<li><!ELEMENT name (#PCDATA)>: #PCDATA is text</li>
<li><!ATTLIST employee no CDATA "">: the type of the attribute “no” in “employee” is CDATA and the default value is “”</li>
</ul>
</li>
<li><code>&lt;!DOCTYPE hr SYSTEM &quot;hr.dtd&quot;&gt;</code> in XML to import the dtd file<h4 id="XML-schema"><a href="#XML-schema" class="headerlink" title="XML schema"></a>XML schema</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;schema xmlns=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span><br><span class="line">	&lt;element name=&quot;hr&quot;&gt;</span><br><span class="line">		&lt;!-- complexType标签含义是复杂节点，包含子节点时必须使用这个标签 --&gt;</span><br><span class="line">		&lt;complexType&gt;</span><br><span class="line">			&lt;sequence&gt;</span><br><span class="line">				&lt;element name=&quot;employee&quot; minOccurs=&quot;1&quot; maxOccurs=&quot;9999&quot;&gt;</span><br><span class="line">					&lt;complexType&gt;</span><br><span class="line">						&lt;sequence&gt;</span><br><span class="line">							&lt;element name=&quot;name&quot; type=&quot;string&quot;&gt;&lt;/element&gt;</span><br><span class="line">							&lt;element name=&quot;age&quot;&gt;</span><br><span class="line">								&lt;simpleType&gt;</span><br><span class="line">									&lt;restriction base=&quot;integer&quot;&gt;</span><br><span class="line">										&lt;minInclusive value=&quot;18&quot;&gt;&lt;/minInclusive&gt;</span><br><span class="line">										&lt;maxInclusive value=&quot;60&quot;&gt;&lt;/maxInclusive&gt;</span><br><span class="line">									&lt;/restriction&gt;</span><br><span class="line">								&lt;/simpleType&gt;</span><br><span class="line">							&lt;/element&gt;</span><br><span class="line">							&lt;element name=&quot;salary&quot; type=&quot;integer&quot;&gt;&lt;/element&gt;</span><br><span class="line">							&lt;element name=&quot;department&quot;&gt;</span><br><span class="line">								&lt;complexType&gt;</span><br><span class="line">									&lt;sequence&gt;</span><br><span class="line">										&lt;element name=&quot;dname&quot; type=&quot;string&quot;&gt;&lt;/element&gt;</span><br><span class="line">										&lt;element name=&quot;address&quot; type=&quot;string&quot;&gt;&lt;/element&gt;</span><br><span class="line">									&lt;/sequence&gt;</span><br><span class="line">								&lt;/complexType&gt;</span><br><span class="line">							&lt;/element&gt;</span><br><span class="line">						&lt;/sequence&gt;</span><br><span class="line">						&lt;attribute name=&quot;no&quot; type=&quot;string&quot; use=&quot;required&quot;&gt;&lt;/attribute&gt;</span><br><span class="line">					&lt;/complexType&gt;</span><br><span class="line">				&lt;/element&gt;</span><br><span class="line">			&lt;/sequence&gt;</span><br><span class="line">		&lt;/complexType&gt;</span><br><span class="line">	&lt;/element&gt;</span><br><span class="line">&lt;/schema&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3></li>
<li>document object model</li>
<li>Dom4j<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.dom4j.Attribute;</span><br><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.DocumentException;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line">public class HrReader &#123;</span><br><span class="line">	public void readXml()&#123;</span><br><span class="line">		String file = &quot;d:/workspace/xml/src/hr.xml&quot;;</span><br><span class="line"></span><br><span class="line">		SAXReader reader = new SAXReader();</span><br><span class="line">		try &#123;</span><br><span class="line">			Document document = reader.read(file);</span><br><span class="line">			Element root = document.getRootElement();</span><br><span class="line">			List&lt;Element&gt; employees =  root.elements(&quot;employee&quot;);</span><br><span class="line">			for (Element employee : employees)&#123;</span><br><span class="line">				Element name = employee.element(&quot;name&quot;);</span><br><span class="line">				String empName = name.getText();</span><br><span class="line">				System.out.println(empName);</span><br><span class="line">				System.out.println(employee.elementText(&quot;age&quot;));</span><br><span class="line">				System.out.println(employee.elementText(&quot;salary&quot;));</span><br><span class="line">				Element department = employee.element(&quot;department&quot;);</span><br><span class="line">				System.out.println(department.element(&quot;dname&quot;).getText());</span><br><span class="line">				System.out.println(department.element(&quot;address&quot;).getText());</span><br><span class="line">				Attribute att = employee.attribute(&quot;no&quot;);</span><br><span class="line">				System.out.println(att.getText());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (DocumentException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		HrReader reader = new HrReader();</span><br><span class="line">		reader.readXml();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.OutputStreamWriter;</span><br><span class="line">import java.io.Writer;</span><br><span class="line"></span><br><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.DocumentException;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line">public class HrWriter &#123;</span><br><span class="line">	public void writeXml()&#123;</span><br><span class="line">		String file = &quot;d:/workspace/xml/src/hr.xml&quot;;</span><br><span class="line">		SAXReader reader = new SAXReader();</span><br><span class="line">		try &#123;</span><br><span class="line">			Document document = reader.read(file);</span><br><span class="line">			Element root = document.getRootElement();</span><br><span class="line">			Element employee = root.addElement(&quot;employee&quot;);</span><br><span class="line">			employee.addAttribute(&quot;no&quot;, &quot;3311&quot;);</span><br><span class="line">			Element name = employee.addElement(&quot;name&quot;);</span><br><span class="line">			name.setText(&quot;Liam&quot;);</span><br><span class="line">			employee.addElement(&quot;age&quot;).setText(&quot;37&quot;);</span><br><span class="line">			employee.addElement(&quot;salary&quot;).setText(&quot;3600&quot;);</span><br><span class="line">			Element department = employee.addElement(&quot;department&quot;);</span><br><span class="line">			department.addElement(&quot;dname&quot;).setText(&quot;IT&quot;);</span><br><span class="line">			department.addElement(&quot;address&quot;).setText(&quot;N2J 3C5&quot;);</span><br><span class="line">			Writer writer = new OutputStreamWriter(new FileOutputStream(file) , &quot;UTF-8&quot;);</span><br><span class="line">			document.write(writer);</span><br><span class="line">			writer.close();</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		HrWriter hrWriter = new HrWriter();</span><br><span class="line">		hrWriter.writeXml();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a>XPath</h3><ul>
<li>to search data in XML<br><img src="/../image/java-web/1.png" alt="Xpath 1"><br><img src="/../image/java-web/2.png" alt="Xpath 2"><br><img src="/../image/java-web/3.png" alt="Xpath 2"></li>
<li>Jaxen<ul>
<li>a Xpath library that supports DOM, XOM, Dom4j, and JDOM</li>
<li>Dom4j depends on Jaxen<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import java.util.List;</span><br><span class="line">import org.dom4j.Document;</span><br><span class="line">import org.dom4j.DocumentException;</span><br><span class="line">import org.dom4j.Element;</span><br><span class="line">import org.dom4j.Node;</span><br><span class="line">import org.dom4j.io.SAXReader;</span><br><span class="line"></span><br><span class="line">public class XPathTestor &#123;</span><br><span class="line">	public void xpath(String xpathExp)&#123;</span><br><span class="line">		String file = &quot;E:/lianxi/xml/hr.xml&quot;;</span><br><span class="line">		SAXReader reader = new SAXReader();</span><br><span class="line">		try &#123;</span><br><span class="line">			Document document = reader.read(file);</span><br><span class="line"></span><br><span class="line">			List&lt;Node&gt; nodes = document.selectNodes(xpathExp);</span><br><span class="line">			for(Node node : nodes)&#123;</span><br><span class="line">				Element emp = (Element)node;</span><br><span class="line">				System.out.println(emp.attributeValue(&quot;no&quot;));</span><br><span class="line">				System.out.println(emp.elementText(&quot;name&quot;));</span><br><span class="line">				System.out.println(emp.elementText(&quot;age&quot;));</span><br><span class="line">				System.out.println(emp.elementText(&quot;salary&quot;));</span><br><span class="line">				System.out.println(&quot;==============================&quot;);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&#125; catch (DocumentException e) &#123;</span><br><span class="line">			// TODO Auto-generated catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		XPathTestor testor = new XPathTestor();</span><br><span class="line">//		testor.xpath(&quot;/hr/employee&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee[salary&lt;4000]&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee[name=&#x27;������&#x27;]&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee[@no=3304]&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee[1]&quot;);</span><br><span class="line">//		testor.xpath(&quot;//employee[last()]&quot;);</span><br><span class="line">		//testor.xpath(&quot;//employee[position()&lt;3]&quot;);</span><br><span class="line">		testor.xpath(&quot;//employee[3] | //employee[8]&quot;);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="Tomcat"><a href="#Tomcat" class="headerlink" title="Tomcat"></a>Tomcat</h2><ul>
<li>Tomcat: web application server software, a container to run Servlet</li>
<li>configuration<ul>
<li>port</li>
<li>ContextPath</li>
<li>应用自动重载</li>
</ul>
</li>
</ul>
<h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><ul>
<li><p>Server Applet, to create dynamic web content</p>
</li>
<li><p>process: request -&gt; Tomcat -&gt; search in web.xml to find the relevant Servlet -&gt; Servlet runs -&gt; response</p>
</li>
<li><p>steps</p>
<ul>
<li><p>extends HttpServlet</p>
</li>
<li><p>override service(HttpServletRequest request , HttpServletResponse response)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PrintWriter out =  response.getWriter();</span><br><span class="line">out.println(&quot;&lt;a href=&#x27;http://www.baidu.com&#x27;&gt;Baidu&lt;/a&gt;&quot;);</span><br></pre></td></tr></table></figure></li>
<li><p>configure web.xml or use annotation</p>
<ul>
<li>XML<ul>
<li><load-on-startup>0~9999</load-on-startup>, 0 means this Servlet has the highest priority</li>
<li>default home page</li>
<li>status code and page</li>
<li>Servlet 通配符映射及初始化参数<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; id=&quot;WebApp_ID&quot; version=&quot;3.1&quot;&gt;</span><br><span class="line">  &lt;display-name&gt;servlet_advanced&lt;/display-name&gt;</span><br><span class="line">  &lt;welcome-file-list&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.htm&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.html&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.htm&lt;/welcome-file&gt;</span><br><span class="line">    &lt;welcome-file&gt;default.jsp&lt;/welcome-file&gt;</span><br><span class="line">  &lt;/welcome-file-list&gt;</span><br><span class="line">  &lt;servlet&gt;</span><br><span class="line">  	&lt;servlet-name&gt;patternServlet&lt;/servlet-name&gt;</span><br><span class="line">  	&lt;servlet-class&gt;com.imooc.servlet.pattern.PatternServlet&lt;/servlet-class&gt;</span><br><span class="line">  &lt;/servlet&gt;</span><br><span class="line">  &lt;servlet-mapping&gt;</span><br><span class="line">  	&lt;servlet-name&gt;patternServlet&lt;/servlet-name&gt;</span><br><span class="line">  	&lt;url-pattern&gt;/pattern/*&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/servlet-mapping&gt;</span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line">  	&lt;param-name&gt;copyright&lt;/param-name&gt;</span><br><span class="line">  	&lt;param-value&gt;© 2018 imooc.com&lt;/param-value&gt;</span><br><span class="line">  &lt;/context-param&gt;</span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line">  	&lt;param-name&gt;title&lt;/param-name&gt;</span><br><span class="line">  	&lt;param-value&gt;Liam Lian&lt;/param-value&gt;</span><br><span class="line">  &lt;/context-param&gt;</span><br><span class="line">  &lt;!-- 指定错误页面 --&gt;</span><br><span class="line">  &lt;error-page&gt;</span><br><span class="line">  	&lt;error-code&gt;404&lt;/error-code&gt;</span><br><span class="line">  	&lt;location&gt;/error/404.html&lt;/location&gt;</span><br><span class="line">  &lt;/error-page&gt;</span><br><span class="line">  &lt;error-page&gt;</span><br><span class="line">  	&lt;error-code&gt;500&lt;/error-code&gt;</span><br><span class="line">  	&lt;location&gt;/error/500.jsp&lt;/location&gt;</span><br><span class="line">  &lt;/error-page&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>@WebServlet</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@WebServlet(&quot;/anno/*&quot;)</span><br><span class="line">public class AnnotationServlet extends HttpServlet&#123;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class="line">    resp.getWriter().println(&quot;I&#x27;m annotation servlet!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><a href="http://ip:port/context-path/url-mapping">http://ip:port/context-path/url-mapping</a>: context-path is project name by default</p>
</li>
</ul>
</li>
<li><p>methods</p>
<ul>
<li><p>request.getParameter() &#x2F;&#x2F; get one parameter</p>
</li>
<li><p>request.getParameterValues() &#x2F;&#x2F; get multiple parameter values</p>
</li>
<li><p>request.setAttribute(属性名，属性值)</p>
</li>
<li><p>Object attr &#x3D; request.getAttribute(属性名)</p>
</li>
<li><p>request.getRequestURL()</p>
</li>
<li><p>request.getServletContext()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ServletContext context = request.getServletContext();</span><br><span class="line">String copyright = context.getInitParameter(&quot;copyright&quot;);</span><br><span class="line">context.setAttribute(&quot;copyright&quot;, copyright);</span><br></pre></td></tr></table></figure></li>
<li><p>request.getSession()</p>
</li>
<li><p>request.getHeader(“User-Agent”);</p>
</li>
<li><p>service() &#x2F;&#x2F; can deal with all requests</p>
</li>
<li><p>doGet() &#x2F;&#x2F; deal with get requests</p>
</li>
<li><p>doPost &#x2F;&#x2F; deal with post requests</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public void doPost(HttpServletRequest request , HttpServletResponse response) throws IOException&#123;</span><br><span class="line">  String name = request.getParameter(&quot;name&quot;);</span><br><span class="line">  response.getWriter().println(&quot;&lt;h1 style=&#x27;color:red&#x27;&gt;&quot; + name + &quot;&lt;/h1&gt;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>life cycle</p>
<ul>
<li>load: web.xml</li>
<li>constructor</li>
<li>init()</li>
<li>provide service: service(), etc</li>
<li>destroy()</li>
</ul>
</li>
<li><p>note: content in WEB-INF can be accessed only by the server, secure</p>
</li>
</ul>
<h3 id="Forward-and-Redirect"><a href="#Forward-and-Redirect" class="headerlink" title="Forward and Redirect"></a>Forward and Redirect</h3><ul>
<li>request.getRequestDispatcher().forward(): <code>request.getRequestDispatcher(&quot;/direct/index&quot;).forward(request, response);</code><ul>
<li>one request</li>
<li>url that appears will not change</li>
</ul>
</li>
<li>response.sendRedirect(): <code>response.sendRedirect(&quot;/servlet_advanced/direct/index&quot;);</code><ul>
<li>two requests<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4></li>
</ul>
</li>
<li>sent with request to Tomcat</li>
<li>default<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">@WebServlet(&quot;/cookies/index&quot;)</span><br><span class="line">public class ImoocIndexServlet extends HttpServlet &#123;</span><br><span class="line">	private static final long serialVersionUID = 1L;</span><br><span class="line"></span><br><span class="line">    public ImoocIndexServlet() &#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		Cookie[] cs = request.getCookies();</span><br><span class="line">		if (cs == null) &#123;</span><br><span class="line">			response.getWriter().println(&quot;user not login&quot;);</span><br><span class="line">			return;</span><br><span class="line">		&#125;</span><br><span class="line">		String user = null;</span><br><span class="line">		for (Cookie c : cs) &#123;</span><br><span class="line">			System.out.println(c.getName() + &quot;:&quot; + c.getValue());</span><br><span class="line">			if (c.getName().equals(&quot;user&quot;)) &#123;</span><br><span class="line">				user = c.getValue();</span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if (user == null) &#123;</span><br><span class="line">			response.getWriter().println(&quot;user not login&quot;);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			response.getWriter().println(&quot;user:&quot; + user);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">@WebServlet(&quot;/cookies/login&quot;)</span><br><span class="line">public class ImoocLoginServlet extends HttpServlet &#123;</span><br><span class="line">	private static final long serialVersionUID = 1L;</span><br><span class="line"></span><br><span class="line">    public ImoocLoginServlet() &#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		Cookie cookie = new Cookie(&quot;user&quot; , &quot;admin&quot;);</span><br><span class="line">		cookie.setMaxAge(60 * 60 * 24 * 7);</span><br><span class="line">		response.addCookie(cookie);</span><br><span class="line">		response.getWriter().println(&quot;login success&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h4></li>
<li>data related to browser window, saved in Tomcat server memory</li>
<li>通过Cookie的SessionId值提取用户数据</li>
<li>methods<ul>
<li>request.getSession()</li>
<li>getAttribute()</li>
<li>setAttribute()</li>
<li>removeAttribute()</li>
<li>setMaxInactiveInterval: 设置Session超时时间<h4 id="ServletContext"><a href="#ServletContext" class="headerlink" title="ServletContext"></a>ServletContext</h4></li>
</ul>
</li>
<li>one global object<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4></li>
<li>HttpServletRequest</li>
<li>HttpSession</li>
<li>ServletContext: after the application starts and before it closes<h4 id="Char-set"><a href="#Char-set" class="headerlink" title="Char set"></a>Char set</h4></li>
<li>get: before Tomcat 8, server.xml增加URIEncoding&#x3D;”UTF-8”</li>
<li>post: <code>request.setCharacterEncoding(&quot;UTF-8&quot;);</code></li>
<li>response: <code>response.setContentType(&quot;text/html;charset=utf-8&quot;);</code></li>
</ul>
<h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><ul>
<li>对URL进行统一的拦截处理, 过滤器对象在Web应用启动时被创建且全局唯一, 唯一的过滤器对象在并发环境中采用“多线程”提供服务<br>过</li>
<li>implements javax.servlet.Filter</li>
<li>doFilter()</li>
<li>web.xml <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">  &lt;filter-name&gt;MyFirstFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;filter-class&gt;com.imooc.filter.MyFirstFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">  &lt;filter-name&gt;MyFirstFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@WebFilter (filterName=&quot;MyAnnoationFilter&quot;,urlPatterns=&quot;/*&quot;)</span><br><span class="line"> public class MyAnnotationFilter implements Filter &#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>&lt;init-param&gt;</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line">import javax.servlet.annotation.WebFilter;</span><br><span class="line">import javax.servlet.annotation.WebInitParam;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">@WebFilter(filterName=&quot;CharacterEncodingFilter&quot;,urlPatterns=&quot;/*&quot;,</span><br><span class="line">	initParams= &#123;</span><br><span class="line">			@WebInitParam(name=&quot;encoding&quot; , value=&quot;GBK&quot;),</span><br><span class="line">			@WebInitParam(name=&quot;p1&quot; , value=&quot;v1&quot;),</span><br><span class="line">			@WebInitParam(name=&quot;p2&quot; , value=&quot;v2&quot;)</span><br><span class="line">	&#125;)</span><br><span class="line">public class CharacterEncodingFilter implements Filter &#123;</span><br><span class="line">	private String encoding;</span><br><span class="line">	@Override</span><br><span class="line">	public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class="line">		encoding = filterConfig.getInitParameter(&quot;encoding&quot;);</span><br><span class="line">		System.out.println(&quot;encoding:&quot;+encoding);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)</span><br><span class="line">			throws IOException, ServletException &#123;</span><br><span class="line">		HttpServletRequest req = (HttpServletRequest)request;</span><br><span class="line">		req.setCharacterEncoding(encoding);</span><br><span class="line">		HttpServletResponse res = (HttpServletResponse)response;</span><br><span class="line">		res.setContentType(&quot;text/html;charset=&quot; + encoding);</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void destroy() &#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">  &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;filter-class&gt;com.imooc.filter.CharacterEncodingFilter&lt;/filter-class&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;encoding&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;GBK&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;p1&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;v1&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;p2&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;v2&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">&lt;/filter&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h4></li>
</ul>
</li>
<li>Filter.init()</li>
<li>Filter.doFilter()</li>
<li>Filter.destroy()</li>
</ul>
<h4 id="ServletRequest"><a href="#ServletRequest" class="headerlink" title="ServletRequest"></a>ServletRequest</h4><ul>
<li>ServletRequest是所有请求的顶层接口，代表任何”请求”</li>
<li>HttpServletRequest是Http协议请求的抽象接口，是J2EE标准</li>
<li>RequestFacade是HttpServletRequest接口的实现类，由Tomcat创建</li>
</ul>
<h4 id="x2F-映射的问题"><a href="#x2F-映射的问题" class="headerlink" title="&#x2F; 映射的问题"></a>&#x2F; 映射的问题</h4><ul>
<li>&#x2F; 指映射 Web应用根路径，且只对Servlet生效</li>
<li>默认首页index.jsp会让 &#x2F; 失效</li>
<li>&#x2F; 与 &#x2F;* 含义不同，前者指向根路径，后者代表所有</li>
</ul>
<h4 id="chain"><a href="#chain" class="headerlink" title="chain"></a>chain</h4><ul>
<li>过滤器的执行顺序以<filter-mapping>为准</li>
<li>调用chain.doFilter()将请求向后传递</li>
</ul>
<h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><ul>
<li><p>Java server page, separate Java code and HTML, in nature is Servlet, .jsp</p>
</li>
<li><p>.jsp -&gt; Servlet source code -&gt;(compiled) byte code</p>
<h4 id="JSP-code-block"><a href="#JSP-code-block" class="headerlink" title="JSP code block"></a>JSP code block</h4></li>
<li><p>&lt;% java code %&gt;: <code>&lt;% System.out.println(&quot;Hello&quot;); %&gt;</code></p>
<h4 id="JSP-declaration-block"><a href="#JSP-declaration-block" class="headerlink" title="JSP declaration block"></a>JSP declaration block</h4></li>
<li><p>&lt;%! java code %&gt;: <code>&lt;%! public int add(int a,int b)&#123;return a+b;&#125; %&gt;</code></p>
<h4 id="output"><a href="#output" class="headerlink" title="output"></a>output</h4></li>
<li><p>&lt;%&#x3D; java code %&gt;: <code>&lt;%= &quot;&lt;b&gt;&quot; + name + &quot;&lt;/b&gt;&quot; %&gt;</code></p>
<h4 id="JSP-commands"><a href="#JSP-commands" class="headerlink" title="JSP commands"></a>JSP commands</h4></li>
<li><p><code>&lt;%@ page import=&quot;java.util.*&quot; %&gt;</code></p>
<ul>
<li>&lt;%@ page %&gt; 定义当前JSP页面全局设置: <code>&lt;%@page import=&quot;java.util.*,java.text.*&quot; contentType=&quot;text/html;charset=utf-8&quot; isErrorPage=&quot;true&quot;%&gt;</code></li>
<li>&lt;%@ include %&gt; 将其他JSP页面与当前JSP页面合并: <code>&lt;%@include file=&quot;include/header.jsp&quot; %&gt;</code></li>
<li>&lt;%@ taglib %&gt; 引入JSP标签库<h4 id="comments"><a href="#comments" class="headerlink" title="comments"></a>comments</h4></li>
</ul>
</li>
<li><p>&lt;%– comments –%&gt;</p>
</li>
<li><p>&#x2F;&#x2F; 、&#x2F;<em>..</em>&#x2F; 用于注释&lt;%%&gt;java代码</p>
</li>
<li><p><code>&lt;!-- html --&gt;</code> HTML注释</p>
<h3 id="JSP-objects"><a href="#JSP-objects" class="headerlink" title="JSP objects"></a>JSP objects</h3></li>
<li><p>request: HttpServletRequest</p>
</li>
<li><p>response: HttpServletResponse</p>
</li>
<li><p>session: HttpSession</p>
</li>
<li><p>application: ServletContext</p>
</li>
<li><p>out: PrintWriter</p>
</li>
<li><p>page: this (this page)</p>
</li>
<li><p>pageContext: PageContext</p>
</li>
<li><p>config: ServletConfig</p>
</li>
<li><p>exception: Throwable</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot; %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		String url = request.getRequestURL().toString(); // HttpServletRequest</span><br><span class="line">		response.getWriter().println(url);//HttpServletResponse</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;% out.println(&quot;&lt;br&gt;ABCCC&quot;);</span><br><span class="line">		session.setAttribute(&quot;user&quot;, &quot;Liam&quot;);</span><br><span class="line">		out.println((String)session.getAttribute(&quot;user&quot;));</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		String cp = application.getInitParameter(&quot;copyright&quot;) ; //ServletContext</span><br><span class="line">		out.println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">		out.println(cp);</span><br><span class="line">		pageContext.getRequest();</span><br><span class="line">		pageContext.getResponse();</span><br><span class="line">		pageContext.getSession();</span><br><span class="line">		pageContext.getServletContext();</span><br><span class="line">	%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="example"><a href="#example" class="headerlink" title="example"></a>example</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page import=&quot;java.util.*,java.text.*&quot; contentType=&quot;text/html;charset=utf-8&quot; %&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">	boolean isPrime(int num)&#123;</span><br><span class="line">		boolean flag = true;</span><br><span class="line">		for(int j = 2 ; j &lt; num ; j++)&#123;</span><br><span class="line">			if(num % j == 0)&#123;</span><br><span class="line">				flag = false;</span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		return flag;</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	List&lt;Integer&gt; primes = new ArrayList();</span><br><span class="line">	for(int i = 2 ; i&lt;=1000 ; i++)&#123;</span><br><span class="line">		boolean flag = isPrime(i);</span><br><span class="line"></span><br><span class="line">		if(flag == true)&#123;</span><br><span class="line">			primes.add(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	for(int p : primes)&#123;</span><br><span class="line">%&gt;</span><br><span class="line">	&lt;h1 style=&quot;color:red;&quot;&gt;&lt;%=p %&gt;是质数&lt;/h1&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="EL"><a href="#EL" class="headerlink" title="EL"></a>EL</h3></li>
<li><p>Expression Language, to simplify JSP</p>
</li>
<li><p>${expression}</p>
<h4 id="Scope-1"><a href="#Scope-1" class="headerlink" title="Scope"></a>Scope</h4></li>
<li><p>pageScope: <code>&#123;pageScope.student.name&#125;</code></p>
</li>
<li><p>requestScope</p>
</li>
<li><p>sessionScope</p>
</li>
<li><p>applicationScope</p>
</li>
<li><p>if scope is omitted, EL will try to find the value from the smallest scope to the largest scope</p>
</li>
<li><p>${param.参数名}</p>
</li>
</ul>
<h3 id="JSTL"><a href="#JSTL" class="headerlink" title="JSTL"></a>JSTL</h3><ul>
<li>JSP Standard Tag Library, to simplify JSP</li>
<li>put jar files in <code>/WEB-INF/lib</code><ul>
<li>taglibs-standard-spec-1.2.5.jar</li>
<li>taglibs-standard-impl-1.2.5.jar</li>
<li>taglibs-standard-jstlel-1.2.5.jar: to support EL, optional</li>
<li>taglibs-standard-compat-1.2.5.jar: to be compatible with version 1.0, optional</li>
</ul>
</li>
<li>libraries<ul>
<li>core<ul>
<li><p>&lt;%@ taglib prefix&#x3D;”c” uri&#x3D;”<a target="_blank" rel="noopener" href="http://java.sun.com/jsp/jstl/core&quot;">http://java.sun.com/jsp/jstl/core&quot;</a> %&gt;</p>
</li>
<li><p>&lt;c:if&gt;</p>
</li>
<li><p>&lt;c:choose&gt;, &lt;c:when&gt;, &lt;c:otherwise&gt;</p>
</li>
<li><p>&lt;c:forEach&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach var=&quot;p&quot; items=&quot;$&#123;persons&#125;&quot; varStatus = &quot;idx&quot;&gt;</span><br><span class="line">No. $&#123;idx.index + 1&#125; &lt;br/&gt;</span><br><span class="line">name：$&#123;p.name&#125; sex: $&#123;p.sex&#125; age:$&#123;p.age&#125;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;!-- 在Java或者JSP文件中输入 Alt + / 可出现智能提示 --&gt;</span><br><span class="line">&lt;%@ taglib  uri = &quot;http://java.sun.com/jsp/jstl/core&quot; prefix = &quot;c&quot; %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h1&gt;$&#123;requestScope.score&#125;&lt;/h1&gt;</span><br><span class="line">	&lt;c:if test = &quot;$&#123;score &gt;= 60 &#125;&quot;&gt;</span><br><span class="line">		&lt;h1 style = &quot;color:green&quot;&gt;恭喜，你已通过测试&lt;/h1&gt;</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line">	&lt;c:if test = &quot;$&#123;score &lt; 60 &#125;&quot;&gt;</span><br><span class="line">		&lt;h1 style = &quot;color:red&quot;&gt;对不起，再接再厉&lt;/h1&gt;</span><br><span class="line">	&lt;/c:if&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- choose when otherwise --&gt;</span><br><span class="line">	$&#123;grade &#125;</span><br><span class="line">	&lt;c:choose&gt;</span><br><span class="line">		&lt;c:when test=&quot;$&#123;grade == &#x27;A&#x27;&#125;&quot;&gt;</span><br><span class="line">			&lt;h2&gt;你很优秀&lt;/h2&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:when test=&quot;$&#123;grade == &#x27;B&#x27; &#125;&quot;&gt;</span><br><span class="line">			&lt;h2&gt;不错呦&lt;/h2&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:when test=&quot;$&#123;grade == &#x27;C&#x27; &#125;&quot;&gt;</span><br><span class="line">			&lt;h2&gt;水平一般，需要提高&lt;/h2&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:when test = &quot;$&#123;grade == &#x27;D&#x27;&#125;&quot;&gt;</span><br><span class="line">			&lt;h2&gt;需要努力啦，不要气馁&lt;/h2&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:otherwise&gt;</span><br><span class="line">			&lt;h2&gt;一切随缘吧&lt;/h2&gt;</span><br><span class="line">		&lt;/c:otherwise&gt;</span><br><span class="line">	&lt;/c:choose&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- forEach标签用于遍历集合</span><br><span class="line">		List companys = (List)request.getAttribute(&quot;companys&quot;)</span><br><span class="line">		for(Company c : companys)&#123;</span><br><span class="line">			out.print(&quot;...&quot;)</span><br><span class="line">		&#125;</span><br><span class="line">		idx = index</span><br><span class="line">		idx.index属性代表循环的索引值（0开始）</span><br><span class="line">	--&gt;</span><br><span class="line">	&lt;c:forEach varStatus=&quot;idx&quot; items = &quot;$&#123;requestScope.companys &#125;&quot; var = &quot;c&quot;&gt;</span><br><span class="line">		&lt;h2&gt;$&#123;idx.index + 1&#125;-$&#123;c.cname &#125;-$&#123;c.url &#125;&lt;/h2&gt;</span><br><span class="line">	&lt;/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>fmt<ul>
<li>&lt;fmt:formatDate value &#x3D; “” pattern &#x3D; “” &#x2F;&gt;</li>
<li>&lt;fmt:formatNumber value &#x3D; “” pattern &#x3D; “”&#x2F;&gt;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; prefix=&quot;fmt&quot; %&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		request.setAttribute(&quot;amt&quot;, 1987654.326);</span><br><span class="line">		request.setAttribute(&quot;now&quot;, new java.util.Date());</span><br><span class="line">		request.setAttribute(&quot;html&quot;, &quot;&lt;a href=&#x27;index.html&#x27;&gt;index&lt;/a&gt;&quot;);</span><br><span class="line">		request.setAttribute(&quot;nothing&quot;, null);</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;h2&gt;$&#123;now &#125;&lt;/h2&gt;</span><br><span class="line">	&lt;!--</span><br><span class="line">		formatDate pattern</span><br><span class="line">		yyyy - 四位年</span><br><span class="line">		MM - 两位月</span><br><span class="line">		dd - 两位日</span><br><span class="line">		HH - 24小时制</span><br><span class="line">		hh - 12小时制</span><br><span class="line">		mm - 分钟</span><br><span class="line">		ss - 秒数</span><br><span class="line">		SSS - 毫秒</span><br><span class="line">	 --&gt;</span><br><span class="line">	&lt;h2&gt;</span><br><span class="line">		&lt;fmt:formatDate value=&quot;$&#123;requestScope.now &#125;&quot; pattern=&quot;yyyy年MM月dd日 HH时mm分ss秒 SSS毫秒&quot; /&gt;</span><br><span class="line">	&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">	&lt;h2&gt;$&#123;amt &#125;&lt;/h2&gt;</span><br><span class="line">	&lt;h2&gt;¥&lt;fmt:formatNumber value = &quot;$&#123;amt &#125;&quot; pattern=&quot;0,00.00&quot;&gt;&lt;/fmt:formatNumber&gt;元&lt;/h2&gt;</span><br><span class="line">	&lt;h2&gt;null默认值：&lt;c:out value=&quot;$&#123;nothing &#125;&quot; default=&quot;无&quot;&gt;&lt;/c:out&gt; &lt;/h2&gt;</span><br><span class="line">	&lt;h2&gt;&lt;c:out value=&quot;$&#123; html&#125;&quot; escapeXml=&quot;true&quot;&gt;&lt;/c:out&gt;&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>sql</li>
<li>xml</li>
<li>functions</li>
</ul>
</li>
</ul>
<h2 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h2><ul>
<li>export WAR</li>
<li>put WAR in <code>&#123;TOMCAT_HOME&#125;/webapps</code></li>
<li>start: run bin&#x2F;startup.bat</li>
<li><code>&#123;TOMCAT_HOME&#125;/conf/server.xml</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">           connectionTimeout=&quot;20000&quot;</span><br><span class="line">           redirectPort=&quot;8443&quot; /&gt;</span><br><span class="line">&lt;Context path=&quot;/&quot;&gt; &lt;!-- so that we don&#x27;t need to have the project name in the url --&gt;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/12/Java-Core-Test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/12/Java-Core-Test/" class="post-title-link" itemprop="url">Java Core Test</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-12 17:43:13" itemprop="dateCreated datePublished" datetime="2022-04-12T17:43:13-04:00">2022-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-20 16:19:16" itemprop="dateModified" datetime="2022-04-20T16:19:16-04:00">2022-04-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h2><h3 id="Primitive"><a href="#Primitive" class="headerlink" title="Primitive"></a>Primitive</h3><p><img src="/../image/java-core-test/1.png" alt="Primitive"></p>
<h3 id="Non-Primitive"><a href="#Non-Primitive" class="headerlink" title="Non-Primitive"></a>Non-Primitive</h3><h4 id="BigDecimal"><a href="#BigDecimal" class="headerlink" title="BigDecimal"></a>BigDecimal</h4><p>to do</p>
<h2 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h2><ul>
<li>if the integer &#x2F; integer (byte, short, char, int, long), result is integer</li>
<li>i++(return and increment) vs ++i</li>
<li>logical operator: short circuit; &amp; vs &amp;&amp;</li>
<li>priority<ul>
<li>member. index[] call function()</li>
<li>positive+ negative- ++ – bitwise complement ~ !</li>
<li><ul>
<li>&#x2F; %</li>
</ul>
</li>
<li>add+ deduct-  </li>
<li>&lt;&lt; signed right shift&gt;&gt;  unsigned right shift&gt;&gt;&gt;</li>
<li>&lt; &lt;&#x3D; &gt; &gt;&#x3D; instanceof</li>
<li>&#x3D;&#x3D; !&#x3D;</li>
<li>&amp;</li>
<li>|</li>
<li>bitwise XOR^</li>
<li>&amp;&amp;</li>
<li>||</li>
<li>? :</li>
<li>&#x3D; +&#x3D; -&#x3D; *&#x3D; &#x2F;&#x3D; %&#x3D; &amp;&#x3D; |&#x3D; ^&#x3D; &lt;&lt;&#x3D; &gt;&gt;&#x3D; &gt;&gt;&gt;&#x3D;</li>
</ul>
</li>
</ul>
<h2 id="Control"><a href="#Control" class="headerlink" title="Control"></a>Control</h2><ul>
<li>Labeled break and continue statements</li>
</ul>
<h2 id="Modifier"><a href="#Modifier" class="headerlink" title="Modifier"></a>Modifier</h2><h3 id="Access"><a href="#Access" class="headerlink" title="Access"></a>Access</h3><ul>
<li>public</li>
<li>private</li>
<li>default<ul>
<li>class and method: same package</li>
</ul>
</li>
<li>protected<ul>
<li>method: same package or subclasses</li>
</ul>
</li>
</ul>
<h3 id="Non-Access"><a href="#Non-Access" class="headerlink" title="Non-Access"></a>Non-Access</h3><h4 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h4><ul>
<li>final: no inheritance</li>
<li>abstract: no instantiation</li>
</ul>
<h4 id="Member"><a href="#Member" class="headerlink" title="Member"></a>Member</h4><ul>
<li>final<ul>
<li>variable<ul>
<li><p>primitive: cannot be modified</p>
</li>
<li><p>non-primitive: cannot refer to another object but the object can be modified</p>
</li>
<li><p>variable as member: should be initialized when being declared or in instance initialization block or constructor</p>
</li>
<li><p>variable in method: should be initialized before using</p>
</li>
</ul>
</li>
<li>method: can be inherited but can’t be overridden; cannot be used on a constructor</li>
</ul>
</li>
<li>static: belong to the class rather than an object; cannot be added to a variable in a method</li>
<li>abstract:<ul>
<li>class: abstract class cannot have <code>final</code></li>
<li>method<ul>
<li>can only be used on methods in an abstract class or an interface.</li>
<li>not have a body.</li>
<li>must be implemented in the subclass unless the subclass is abstract.</li>
<li>cannot have <code>static</code> or <code>private</code></li>
</ul>
</li>
</ul>
</li>
<li>transient: attributes and methods are skipped when serializing the object</li>
<li>synchronized: accessed by only one thread at a time</li>
<li>volatile: the value of an attribute is not cached thread-locally, and is always read from the “main memory”</li>
</ul>
<h3 id="Class-1"><a href="#Class-1" class="headerlink" title="Class"></a>Class</h3><p><img src="/../image/java-core-test/2.png" alt="instantiation"></p>
<ul>
<li>can call a constructor in the first line of another constructor, but cannot call a constructor in a method</li>
<li>Use multiple classes: try to find an accessible class in the current class, if not successful, try to find in the current package<h4 id="Block"><a href="#Block" class="headerlink" title="Block"></a>Block</h4></li>
<li>execution sequence: static block -&gt; instance initialization block -&gt; constructor</li>
<li>static block: cannot assign non-static member variable and declare static member; member declared in static block cannot be accessed from outside</li>
<li>the scope of the variable declared in a method is throughout the method, so we cannot declare the same variable in a block inside the method<h4 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h4></li>
<li>method and block: stack</li>
</ul>
<h4 id="Inner-class"><a href="#Inner-class" class="headerlink" title="Inner class"></a>Inner class</h4><ul>
<li><p>Non-static member inner classes</p>
<ul>
<li>outer$inner.class</li>
<li>cannot have static members</li>
<li><code>Person.Heart heart = new Person().new Heart();</code> or  <code>Person.Heart heart = new Person().getHeart();</code></li>
<li>can access members of the outer class.</li>
<li>方法访问某个变量<ul>
<li>该方法有该名字的成员变量 -&gt; 直接用该变量名</li>
<li>内部类中有该名字的成员变量 -&gt; 使用this.变量名</li>
<li>外部类中有该名字的成员变量 -&gt; 使用外部类的类名.this.非静态变量名 or 外部类的类名.静态变量 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class Outer &#123;</span><br><span class="line"></span><br><span class="line">    private int i = 1;</span><br><span class="line"></span><br><span class="line">    public class Inner &#123;</span><br><span class="line">        private int i = 2;</span><br><span class="line"></span><br><span class="line">        public void print() &#123;</span><br><span class="line">            int i = 3;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">            System.out.println(this.i);</span><br><span class="line">            System.out.println(Outer.this.i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Outer outer = new Outer();</span><br><span class="line">        Inner inner = outer.new Inner();</span><br><span class="line">        inner.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>Static member inner class</p>
<ul>
<li>cannot directly access non-static members of the outer class but can access them through an instance of the outer class</li>
<li><code>Person.Heart heart = new Person.Heart();</code></li>
<li>方法访问某个变量<ul>
<li>该方法有该名字的成员变量 -&gt; 直接用该变量名</li>
<li>内部类中有该名字的成员变量 -&gt; 使用this.变量名</li>
<li>外部类中有该名字的static 成员变量 -&gt; 使用外部类的类名.变量名</li>
<li>外部类中有该名字的non-static 成员变量 -&gt; 使用new 外部类的类名().变量名</li>
</ul>
</li>
<li>when to used: when the inner class does not need to access the members of the outer class</li>
<li>outer$inner.class</li>
</ul>
</li>
<li><p>Method inner class</p>
<ul>
<li><p>scope: method</p>
</li>
<li><p>cannot have access modifier and static</p>
</li>
<li><p>cannot have static member but can have final and abstract member</p>
</li>
<li><p>类中普通方法如需访问外部方法中的局部变量，则该变量也需定义为final（jdk1.8之后底层默认会给该变量加上final）<br>···<br>public class Outer {<br>   private int s &#x3D; 100;<br>   private int out_i &#x3D; 1;<br>   public void f(final int k){<br> final int s &#x3D; 200;<br> final int j &#x3D; 10;<br> class Inner{ &#x2F;&#x2F;定义在方法内部<br>     int s &#x3D; 300;&#x2F;&#x2F;可以定义与外部类同名的变量<br>     &#x2F;&#x2F;static int m &#x3D; 20;&#x2F;&#x2F;不可以定义静态变量<br>     Inner(int k){<br>         inner_f(k);<br>     }<br>     int inner_i &#x3D; 100;<br>     void inner_f(int k){<br>         System.out.println(out_i);&#x2F;&#x2F;如果内部类没有与外部类同名的变量，在内部类中可以直接访问外部类的实例变量<br>         System.out.println(k);&#x2F;&#x2F;<em><strong><strong>可以访问外部类的局部变量(即方法内的变量)，但是变量必须是final的</strong></strong></em><br>         &#x2F;&#x2F;System.out.println(i);<br>         System.out.println(s);&#x2F;&#x2F;如果内部类中有与外部类同名的变量，直接用变量名访问的是内部类的变量<br>         System.out.println(this.s);&#x2F;&#x2F;用”this.变量名” 访问的也是内部类变量<br>         System.out.println(Outer.this.s);&#x2F;&#x2F;用外部”外部类类名.this.变量名” 访问的是外部类变量<br>     }<br>}<br>new Inner(k);<br>}</p>
<p>  public static void main(String[] args) {<br>  &#x2F;&#x2F;访问局部内部类必须先有外部类对象<br>  Outer out &#x3D; new Outer();<br>  out.f(3);<br>  }</p>
</li>
</ul>
<p> }<br>   ···</p>
<ul>
<li>outer$1inner.class</li>
<li>when to used: the class only used in this method</li>
</ul>
</li>
<li><p>Anonymous inner class</p>
<ul>
<li>must inherit a class or implement an interface</li>
<li>cannot have access modifier, static, abstract, or final</li>
<li>cannot have static members</li>
<li>cannot have constructor, but can have instance initialization block</li>
<li>outer$1.class</li>
</ul>
</li>
</ul>
<h4 id="Inner-class-in-interface"><a href="#Inner-class-in-interface" class="headerlink" title="Inner class in interface"></a>Inner class in interface</h4><ul>
<li>non-abstract inner: <code>new InterfaceName.Inner();</code>; or import and then <code>new Inner();</code>; or create a “get” method</li>
<li>abstract inner:<ul>
<li>implementation method 1: create a non-abstract class implements the interface. Inside this class, create a non-abstract class to inherit the abstract inner class in the interface.</li>
<li>implementation method 2: Anonymous inner class</li>
</ul>
</li>
</ul>
<h3 id="Wrapper-Class"><a href="#Wrapper-Class" class="headerlink" title="Wrapper Class"></a>Wrapper Class</h3><h4 id="boxing"><a href="#boxing" class="headerlink" title="boxing"></a>boxing</h4><ul>
<li><p>manual boxing</p>
<ul>
<li>new Integer(1);</li>
<li>Integer.valueOf(1);</li>
</ul>
</li>
<li><p>manual unboxing</p>
<ul>
<li>xxValue(): i1.intValue();</li>
</ul>
</li>
</ul>
<h4 id="unboxing"><a href="#unboxing" class="headerlink" title="unboxing"></a>unboxing</h4><ul>
<li><p>&#x3D;, pass pamameter, use operator to do operations</p>
</li>
<li><p>autoboxing: use valueOf()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int intVal = 1;</span><br><span class="line">Integer integerVal = intVal;</span><br></pre></td></tr></table></figure>
</li>
<li><p>auto unboxing: use xxValue()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int intVal = integerVal;</span><br></pre></td></tr></table></figure>
<h4 id="常量池"><a href="#常量池" class="headerlink" title="常量池"></a>常量池</h4></li>
<li><p>.valueOf()</p>
</li>
<li><p>-128 &lt;&#x3D; x &lt;&#x3D; 127</p>
</li>
<li><p>except Float and Double</p>
<h4 id="Compare"><a href="#Compare" class="headerlink" title="Compare"></a>Compare</h4></li>
<li><p>&#x3D;&#x3D; compares addresses</p>
</li>
<li><p><code>a.equals(b)</code> compares type and value. If b is primitive, auto-box it.</p>
<h4 id="Frequently-used-methods"><a href="#Frequently-used-methods" class="headerlink" title="Frequently used methods"></a>Frequently used methods</h4><h4 id="String"><a href="#String" class="headerlink" title="String"></a>String</h4></li>
<li><p><code>Integer.toString(1);</code></p>
</li>
<li><p><code>Integer.parseInt(&quot;1&quot;);</code> to <code>int</code></p>
</li>
<li><p><code>Integer.valueOf(&quot;1&quot;);</code> to <code>Integer</code></p>
</li>
</ul>
<h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h3><ul>
<li>overload: same name, different parameter numbers or types</li>
<li>override<ul>
<li>in subclasses</li>
<li>same name, same parameters (sequence, number, type)</li>
<li>modifier &gt;&#x3D; that of superclass</li>
<li>return<ul>
<li>if return void or primitive: return type should be same as that of superclass</li>
<li>if return non-primitive: return type can be the same of that of the overridden method or its subclass</li>
</ul>
</li>
<li>cannot override constructor, final, and static methods (can declare static methods again)</li>
<li>if subclass and its superclass are in the same package, can override non-private methods except those mentioned above</li>
<li>if subclass and its superclass are not in the same package, can override public or protected methods except those mentioned above</li>
<li>overriding method can throw any unchecked exception</li>
<li>overriding method cannot throw a checked exception that is new or more general than that in the overridden method</li>
</ul>
</li>
<li>variable arguments: <code>int... args</code></li>
</ul>
<h3 id="String-1"><a href="#String-1" class="headerlink" title="String"></a>String</h3><ul>
<li>immutable</li>
<li>&#x3D;&#x3D; address; equals() content</li>
<li>“s” is constant is in the constant pool. <code>String s = new String(&quot;s&quot;)</code> will check the constant pool first. If exist, use directly.</li>
<li><code>new String(&quot;s&quot;)</code> creates “s” in the constant pool first and then create an object on heap.</li>
<li>char array or byte array<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">char[] chars = &#123;&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;&#125;;</span><br><span class="line">String s1 = new String(chars);</span><br><span class="line">String s2 = new String(chars, 1, 2); // bc</span><br><span class="line"></span><br><span class="line">byte[] b = &#123;54, 69, 70, 71, 72&#125;; // ASCII</span><br><span class="line">String s3 = new String(b);</span><br><span class="line">String s4 = new String(b, 1, 2);</span><br><span class="line">String s5 = new String(b, &quot;utf-8&quot;);</span><br><span class="line">String s6 = new String(b, 1, 2, &quot;utf-8&quot;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Frequently-Used-Methods"><a href="#Frequently-Used-Methods" class="headerlink" title="Frequently Used Methods"></a>Frequently Used Methods</h4><p><img src="/../image/java-core-test/7.png" alt="Primitive"></p>
<ul>
<li><code>.getBytes()</code> or <code>.getBytes(&quot;utf-8&quot;)</code></li>
<li>firstName.concat(lastName)</li>
</ul>
<h4 id="StringBuilder"><a href="#StringBuilder" class="headerlink" title="StringBuilder"></a>StringBuilder</h4><ul>
<li>mutable, thread-unsafe<h5 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h5></li>
<li>StringBuilder append(“s”)</li>
<li>StringBuilder insert(position, “s”)</li>
<li>String toString()</li>
<li>int length()</li>
</ul>
<h4 id="StringBuffer"><a href="#StringBuffer" class="headerlink" title="StringBuffer"></a>StringBuffer</h4><ul>
<li>mutable, thread-safe</li>
</ul>
<h3 id="Object-Class"><a href="#Object-Class" class="headerlink" title="Object Class"></a>Object Class</h3><ul>
<li>superclass of any class</li>
<li>equals: addresse1 &#x3D;&#x3D; addresse2</li>
<li>toString: <code>getClass().getName() + &#39;@&#39; + Integer.toHexString(hashCode())</code>; when using sout, used by default</li>
<li>hashCode: This is typically implemented by converting the internal address of the object into an integer, but this implementation technique is not required by the Java™ programming language.</li>
<li>getClass: Returns the runtime class of this object</li>
</ul>
<h4 id="hashCode"><a href="#hashCode" class="headerlink" title="hashCode()"></a>hashCode()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public int hashCode() &#123;</span><br><span class="line">  final int prime = 31;</span><br><span class="line">  int result = 1;</span><br><span class="line">  result = prime * result + age;</span><br><span class="line">  result = prime * result + ((name == null) ? 0 : name.hashCode());</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="equals"><a href="#equals" class="headerlink" title="equals()"></a>equals()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object obj) &#123;</span><br><span class="line">  if (obj == null) &#123;</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (this == obj) &#123;</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (obj.getClass() == Cat.class) &#123;</span><br><span class="line">    Cat cat = (Cat) obj;</span><br><span class="line">    return cat.getName().equals(name) &amp;&amp; (cat.getAge() == age);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return false;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h3><ul>
<li>decide which class’ method to use based on the type of instance that calls a method</li>
<li>need to have<ul>
<li>inheritance</li>
<li>superclass reference refers to subclass instance</li>
</ul>
</li>
<li>upcast: <code>Animal animal = new Cat();</code>. cannot call a method that is not declared in superclass</li>
<li>downcast: <code>Cat cat = (Cat)(new Animal());</code>. can use a method not declared in superclass but declared in subclass. Note the operation priority: <code>((Chinese)person).kungfu();</code>.</li>
<li><code>instanceof</code>: <code>cat instanceof Animal; //true</code>. can only be converted into its original type.</li>
</ul>
<h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><ul>
<li>is-a</li>
<li>only one superclass</li>
<li>super</li>
<li>constructor<ul>
<li>When construct a subclass, must use the constructor of its superclass. Default is the superclass constructor without parameters. Error if it does not exist.</li>
<li>Use <code>super</code> to call a superclass constructor. Must be put in the first line of the constructor.</li>
</ul>
</li>
</ul>
<h3 id="Interface-vs-Abstract"><a href="#Interface-vs-Abstract" class="headerlink" title="Interface vs Abstract"></a>Interface vs Abstract</h3><h4 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h4><p>···<br>[default or public] interface InterfaceName [extends SuperInterfaceName1, SuperInterfaceName2, …] {<br>    [public static final] TypeName CONSTANT &#x3D; ;<br>    [public abstract] TypeName abstractMethod([args]); &#x2F;&#x2F; no body<br>    [public] default TypeName defaultMethod([args]){}; &#x2F;&#x2F; the overriding method does not need to have <code>default</code>; In the overriding method, can use InterfaceName.super.methodName() to call the original method<br>    [public] static TypeName staticMethod() {}; &#x2F;&#x2F; cannot be inherited or overridden, but the implementation class can declare again<br>}<br>···</p>
<ul>
<li>A class can implement multiple interfaces separated by commas. If so, can inherit only abstract methods</li>
<li>If the implementation class implements multiple interfaces which have the same method, the implementation class should override the method</li>
<li>If the implementation class extends a superclass and implements multiple interfaces and the superclass and interfaces have the same method and the same member variable, and if the implementation class does not override the method, by default the method in the superclass will be used when needed, but cannot tell which member variable to use</li>
</ul>
<h3 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h3><p><img src="/../image/java-core-test/4.png" alt="Exception and Error"></p>
<ul>
<li><p>checked exception: must use “try-catch” or “throws”</p>
</li>
<li><p>try</p>
</li>
<li><p>catch: optional; catch by type; if caught, will not enter other catch blocks, so put catch blocks for smaller-scope exceptions first and put <code>catch(Exception)</code> at last; <code>System.exit(1);</code> will end the program</p>
</li>
<li><p>finally: optional; will run no matter whether there is an exception; if there is no catch block, must have finally block; used to release resource<br><img src="/../image/java-core-test/5.png" alt="finally"><br><img src="/../image/java-core-test/6.png" alt="finally"></p>
</li>
<li><p>throws: declare some potential exceptions, the method that calls this method will deal with the exception</p>
</li>
<li><p>throw: throw an instance, Throwable or its subclass</p>
</li>
<li><p>the scope of variable declared in try, catch, finally blocks is the block</p>
</li>
<li><p>inherit Throwable or its subclass</p>
</li>
<li><p>exception chain</p>
<ul>
<li>Throwable(String message, Throwable cause)</li>
<li>Throwable(Throwable cause)</li>
<li>initCause(Throwable cause): initialize the cause of this throwable to the specified value.</li>
</ul>
</li>
<li><p>method</p>
</li>
</ul>
<ul>
<li>toString()</li>
<li>getMessage()</li>
<li>printStackTrace()</li>
</ul>
<ul>
<li>common exception types<ul>
<li>Exception</li>
<li>ArithmeticException</li>
<li>ArrayIndexOutOfBoundsException</li>
<li>ArrayStoreException</li>
<li>NullPointerException</li>
<li>ClassNotFoundException</li>
<li>IllegalArgumentException</li>
<li>InputMismatchException</li>
<li>ClassCastException</li>
<li>NumberFormatException</li>
<li>FileNotFoundException</li>
</ul>
</li>
</ul>
<h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><h4 id="File"><a href="#File" class="headerlink" title="File"></a>File</h4><ul>
<li><p>File(File parent, String child): Creates a new File instance from a parent abstract pathname and a child pathname string.</p>
</li>
<li><p>File(String pathname): Creates a new File instance by converting the given pathname string into an abstract pathname.</p>
</li>
<li><p>File(String parent, String child): Creates a new File instance from a parent pathname string and a child pathname string.</p>
</li>
<li><p>File(URI uri): Creates a new File instance by converting the given file: URI into an abstract pathname.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File file1=new File(&quot;c:\\imooc\\io\\score.txt&quot;); // Windows: \\, linux: /</span><br><span class="line">File file1=new File(&quot;c:\\imooc&quot;,&quot;io\\score.txt&quot;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>isDirectory()</p>
</li>
<li><p>isFile()</p>
</li>
<li><p>exists()</p>
</li>
<li><p>mkdir()</p>
</li>
<li><p>mkdirs()</p>
</li>
<li><p>createNewFile()</p>
<h4 id="Byte-Stream"><a href="#Byte-Stream" class="headerlink" title="Byte Stream"></a>Byte Stream</h4><h5 id="FileInputStream"><a href="#FileInputStream" class="headerlink" title="FileInputStream"></a>FileInputStream</h5></li>
<li><p>FileInputStream(File file): Creates a FileInputStream by opening a connection to an actual file, the file named by the File object file in the file system.</p>
</li>
<li><p>FileInputStream(FileDescriptor fdObj): Creates a FileInputStream by using the file descriptor fdObj, which represents an existing connection to an actual file in the file system.</p>
</li>
<li><p>FileInputStream(String name): Creates a FileInputStream by opening a connection to an actual file, the file named by the path name name in the file system.</p>
</li>
<li><p>public int read() &#x2F;&#x2F; return the next byte of data, or -1 if the end of the file is reached.</p>
</li>
<li><p>public int read(byte[] b) &#x2F;&#x2F; the total number of bytes read into the buffer, or -1 if there is no more data because the end of the file has been reached.</p>
</li>
<li><p>public int read(byte[] b, int off, int len) &#x2F;&#x2F; off is the byte array starting index from which we save data</p>
</li>
<li><p>public void close()</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public class FileInputDemo1 &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">		try &#123;</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line"></span><br><span class="line">			int n = 0;</span><br><span class="line"></span><br><span class="line">			while((n = fis.read()) != -1)&#123;</span><br><span class="line">				System.out.print((char)n);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			fis.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch(IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class FileInputDemo2 &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			byte[] b = new byte[100];</span><br><span class="line">			fis.read(b, 0, 5);</span><br><span class="line">			System.out.println(new String(b));</span><br><span class="line">			fis.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="FileOutputStream"><a href="#FileOutputStream" class="headerlink" title="FileOutputStream"></a>FileOutputStream</h5><ul>
<li><p>FileOutputStream(File file): Creates a file output stream to write to the file represented by the specified File object.</p>
</li>
<li><p>FileOutputStream(File file, boolean append): Creates a file output stream to write to the file represented by the specified File object.</p>
</li>
<li><p>FileOutputStream(FileDescriptor fdObj): Creates a file output stream to write to the specified file descriptor, which represents an existing connection to an actual file in the file system.</p>
</li>
<li><p>FileOutputStream(String name): Creates a file output stream to write to the file with the specified name.</p>
</li>
<li><p>FileOutputStream(String name, boolean append): Creates a file output stream to write to the file with the specified name.</p>
</li>
<li><p>public void write(int b)</p>
</li>
<li><p>public void write(byte[] b)</p>
</li>
<li><p>public void write(byte[] b, int off, int len) &#x2F;&#x2F; starting from index off in the byte array, save len bytes to the file</p>
</li>
<li><p>public void close()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public class FileOutputDemo &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		FileOutputStream fos;</span><br><span class="line">		FileInputStream fis;</span><br><span class="line">		try &#123;</span><br><span class="line">			fos = new FileOutputStream(&quot;imooc.txt&quot;,true);</span><br><span class="line">			fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			fos.write(50);</span><br><span class="line">			fos.write(&#x27;a&#x27;);</span><br><span class="line">			System.out.println(fis.read());</span><br><span class="line">			System.out.println((char)fis.read());</span><br><span class="line"></span><br><span class="line">      // first opened, first closed</span><br><span class="line">			fos.close();</span><br><span class="line">			fis.close();</span><br><span class="line"></span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class FileOutputDemo1 &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		// copy a file</span><br><span class="line">		try &#123;</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;happy.gif&quot;);</span><br><span class="line">			FileOutputStream fos = new FileOutputStream(&quot;happycopy.gif&quot;);</span><br><span class="line">			int n = 0;</span><br><span class="line">			byte[] b = new byte[1024];</span><br><span class="line">			while ((n = fis.read(b)) != -1) &#123;</span><br><span class="line">				fos.write(b, 0, n);</span><br><span class="line">			&#125;</span><br><span class="line">			fis.close();</span><br><span class="line">			fos.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line"></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch(IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="BufferedInputStream-and-BufferedOutputStream"><a href="#BufferedInputStream-and-BufferedOutputStream" class="headerlink" title="BufferedInputStream and BufferedOutputStream"></a>BufferedInputStream and BufferedOutputStream</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedInputStream;</span><br><span class="line">import java.io.BufferedOutputStream;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public class BufferedDemo &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			FileOutputStream fos = new FileOutputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			BufferedOutputStream bos = new BufferedOutputStream(fos);</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			BufferedInputStream bis = new BufferedInputStream(fis);</span><br><span class="line">			long startTime = System.currentTimeMillis();</span><br><span class="line">			bos.write(50);</span><br><span class="line">			bos.write(&#x27;a&#x27;);</span><br><span class="line">			bos.flush(); // The buffer is not full yet. Force to write the content inf the buffer to the file and clear the buffer</span><br><span class="line"></span><br><span class="line">			System.out.println(bis.read());</span><br><span class="line">			System.out.println((char)bis.read());</span><br><span class="line">			long endTime = System.currentTimeMillis();</span><br><span class="line">			System.out.println(endTime - startTime);</span><br><span class="line"></span><br><span class="line">			fos.close();</span><br><span class="line">			bos.close();</span><br><span class="line">			fis.close();</span><br><span class="line">			bis.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="character-stream"><a href="#character-stream" class="headerlink" title="character stream"></a>character stream</h4><h5 id="InputStreamReader-OutputStreamReader-BufferedReader-BufferedWriter"><a href="#InputStreamReader-OutputStreamReader-BufferedReader-BufferedWriter" class="headerlink" title="InputStreamReader, OutputStreamReader, BufferedReader, BufferedWriter"></a>InputStreamReader, OutputStreamReader, BufferedReader, BufferedWriter</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.BufferedWriter;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.io.OutputStreamWriter;</span><br><span class="line"></span><br><span class="line">public class ReaderDemo &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			InputStreamReader isr = new InputStreamReader(fis, &quot;GBK&quot;);</span><br><span class="line">			BufferedReader br = new BufferedReader(isr);</span><br><span class="line"></span><br><span class="line">			FileOutputStream fos = new FileOutputStream(&quot;imooc1.txt&quot;);</span><br><span class="line">			OutputStreamWriter osw = new OutputStreamWriter(fos, &quot;GBK&quot;);</span><br><span class="line">			BufferedWriter bw = new BufferedWriter(osw);</span><br><span class="line"></span><br><span class="line">			int n = 0;</span><br><span class="line">			char[] cbuf = new char[10];</span><br><span class="line"></span><br><span class="line">			while((n = br.read(cbuf)) != -1)&#123;</span><br><span class="line">				bw.write(cbuf, 0, n);</span><br><span class="line">				bw.flush();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			fis.close();</span><br><span class="line">			fos.close();</span><br><span class="line">			isr.close();</span><br><span class="line">			osw.close();</span><br><span class="line">			br.close();</span><br><span class="line">			bw.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Serialization"><a href="#Serialization" class="headerlink" title="Serialization"></a>Serialization</h4><ul>
<li>object to bytes</li>
<li>class implements Serializable</li>
<li>ObjectInputStream and ObjectOutputStream<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectOutputStream;</span><br><span class="line"></span><br><span class="line">public class GoodsTest &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">		Goods goods1 = new Goods(&quot;gd001&quot;, &quot;电脑&quot;, 3000);</span><br><span class="line">		try &#123;</span><br><span class="line">			FileOutputStream fos = new FileOutputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			ObjectOutputStream oos = new ObjectOutputStream(fos);</span><br><span class="line">			FileInputStream fis = new FileInputStream(&quot;imooc.txt&quot;);</span><br><span class="line">			ObjectInputStream ois = new ObjectInputStream(fis);</span><br><span class="line"></span><br><span class="line">			oos.writeObject(goods1);</span><br><span class="line">			oos.writeBoolean(true);</span><br><span class="line">			oos.flush();</span><br><span class="line"></span><br><span class="line">			try &#123;</span><br><span class="line">				Goods goods = (Goods) ois.readObject();</span><br><span class="line">				System.out.println(goods);</span><br><span class="line">			&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(ois.readBoolean());</span><br><span class="line"></span><br><span class="line">			fos.close();</span><br><span class="line">			oos.close();</span><br><span class="line">			fis.close();</span><br><span class="line">			ois.close();</span><br><span class="line">		&#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; catch (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h3><h3 id="Generic-Type"><a href="#Generic-Type" class="headerlink" title="Generic Type"></a>Generic Type</h3><ul>
<li>generic type as method parameter<ul>
<li><? extends Goods>; extends a class or an interface</li>
<li><? super Goods></li>
</ul>
</li>
<li>Define a generic type: <code>class ClassName&lt;T, X&gt; &#123;&#125;</code></li>
<li>generic type method<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class ClassName &#123;</span><br><span class="line">  public &lt;T&gt; void printValue(T t) &#123;</span><br><span class="line">    System.out.println(t);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>泛型的类型参数只能是类类型，不能是基本数据类型</li>
</ul>
<h3 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h3><ul>
<li>see the post “Collection”</li>
</ul>
<h3 id="Multithread"><a href="#Multithread" class="headerlink" title="Multithread"></a>Multithread</h3><ul>
<li>Process: to do</li>
<li>Thread</li>
<li>各线程什么时候得到CPU时间，占用多久，是不可预测的</li>
</ul>
<h4 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h4><ul>
<li><p>create an instance of Thread or its subclass</p>
<ul>
<li>Thread implements Runnable</li>
<li>Thread()</li>
<li>Thread(String name)</li>
<li>Thread(Runnable target)</li>
<li>Thread(Runnable target, String name)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mt1.setPriority(Thread.MAX_PRIORITY);</span><br></pre></td></tr></table></figure>
</li>
<li><p>create an instance of a class that implements Runnable</p>
<ul>
<li>only has one method: run()</li>
<li>why to use: can extend only one class; do not want to override other methods in Thread<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> class PrintRunnable implements Runnable &#123;</span><br><span class="line">int i = 1;</span><br><span class="line">@Override</span><br><span class="line">public void run() &#123;</span><br><span class="line"></span><br><span class="line">	while (i &lt;= 10) &#123;</span><br><span class="line">		System.out.println(Thread.currentThread().getName() + &quot;正在运行&quot; + (i++));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> public class Test &#123;</span><br><span class="line"></span><br><span class="line"> 	public static void main(String[] args) &#123;</span><br><span class="line"> 		PrintRunnable pr = new PrintRunnable();</span><br><span class="line"> 		Thread t1 = new Thread(pr);</span><br><span class="line"> 		t1.start();</span><br><span class="line"> 		Thread t2 = new Thread(pr);</span><br><span class="line"> 		t2.start();</span><br><span class="line"></span><br><span class="line"> 	&#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Callable&lt;&gt;</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import java.util.concurrent.Callable;</span><br><span class="line">public class ThirdThread implements Callable&lt;String&gt; &#123;</span><br><span class="line">  @override</span><br><span class="line">  public String call() throws Exception &#123;</span><br><span class="line">    String str = &quot;the third way to create a thread&quot;;</span><br><span class="line">    return str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class ThirdThreadTest &#123;</span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    Callable&lt;String&gt; call = new ThirdThread();</span><br><span class="line">    FutureTask&lt;String&gt; ft = new FutureTask&lt;&gt;(call);</span><br><span class="line">    Thread thread = new Thread(ft);</span><br><span class="line"></span><br><span class="line">    thread.start();</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">      System.out.println(ft.get()); // get the result after the thread finishes, i.e. &quot;the third way to create a thread&quot;</span><br><span class="line">    &#125; catch (InterruptedException | ExecutionException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Thread-methods"><a href="#Thread-methods" class="headerlink" title="Thread methods"></a>Thread methods</h4></li>
<li><p>public void run()</p>
</li>
<li><p>public void start()</p>
</li>
<li><p>public static void sleep(long m) &#x2F;&#x2F; millisecond, used to do something periodically</p>
</li>
<li><p>public void join() &#x2F;&#x2F; other threads will execute after this thread finishes</p>
</li>
<li><p>public final void join(long millis) &#x2F;&#x2F; 等待该线程终止的最长时间为millis毫秒。如果millis为0则意味着要一直等下去。</p>
</li>
<li><p>getName()</p>
</li>
<li><p>public int getPriority()</p>
</li>
<li><p>public void setPriority(int newPriority)</p>
</li>
<li><p>wait()</p>
</li>
<li><p>notify() &#x2F;&#x2F; 唤醒一个等待线程</p>
</li>
<li><p>nofifyAll() &#x2F;&#x2F;唤醒所有等待线程</p>
<h4 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h4><p><img src="/../image/java-core-test/8.png" alt="thread lifecycle"></p>
</li>
<li><p>stop() is depreciated</p>
<h4 id="Priority"><a href="#Priority" class="headerlink" title="Priority"></a>Priority</h4></li>
<li><p>1 (MIN_PRIORITY) to 10 (MAX_PRIORITY), default is 5 (NORM_PRIORITY)</p>
</li>
<li><p>the thread with higher priority is not necessarily excuted first</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class MyThread extends Thread &#123;</span><br><span class="line">	private String name;</span><br><span class="line">	public MyThread(String name) &#123;</span><br><span class="line">		this.name=name;</span><br><span class="line">	&#125;</span><br><span class="line">	public void run() &#123;</span><br><span class="line">		for (int i = 1; i &lt;= 50; i++) &#123;</span><br><span class="line">			System.out.println(&quot;线程&quot; + name + &quot;正在运行&quot; + i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">public class PriorityDemo &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		//获取主线程的优先级</span><br><span class="line">		int mainPriority = Thread.currentThread().getPriority();</span><br><span class="line">		//System.out.println(&quot;主线程的优先级为：&quot; + mainPriority);</span><br><span class="line">		MyThread mt1 = new MyThread(&quot;线程1&quot;);</span><br><span class="line">		MyThread mt2 = new MyThread(&quot;线程2&quot;);</span><br><span class="line">		//mt1.setPriority(10);</span><br><span class="line">		mt1.setPriority(Thread.MAX_PRIORITY);</span><br><span class="line">		mt2.setPriority(Thread.MIN_PRIORITY);</span><br><span class="line">		mt2.start();</span><br><span class="line">		mt1.start();</span><br><span class="line">		//System.out.println(&quot;线程1的优先级为：&quot; + mt1.getPriority());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h4></li>
<li><p>It is not possible for two invocations of synchronized methods on the same object to interleave. When one thread is executing a synchronized method for an object, all other threads that invoke synchronized methods for the same object block (suspend execution) until the first thread is done with the object.</p>
</li>
<li><p>Second, when a synchronized method exits, it automatically establishes a happens-before relationship with any subsequent invocation of a synchronized method for the same object. This guarantees that changes to the state of the object are visible to all threads.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public synchronized void saveAccount()&#123;&#125;</span><br><span class="line">public static synchronized void saveAccount()&#123;&#125;</span><br><span class="line">synchronized (obj)&#123;……&#125;</span><br><span class="line"></span><br><span class="line">public void drawAccount() &#123;</span><br><span class="line">  synchronized (this) &#123;</span><br><span class="line"></span><br><span class="line">    int balance = getBalance();</span><br><span class="line">    balance = balance - 200;</span><br><span class="line">    try &#123;</span><br><span class="line">      Thread.sleep(1000);</span><br><span class="line">    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    setBalance(balance);</span><br><span class="line">    System.out.println(&quot;取款后的帐户余额：&quot; + balance);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Deadlock"><a href="#Deadlock" class="headerlink" title="Deadlock"></a>Deadlock</h4></li>
<li><p>Deadlock describes a condition in which two or more threads are blocked (hung) forever because they are waiting for each other.</p>
</li>
<li><p>notifyAll();</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class Queue &#123;</span><br><span class="line">	private int n;</span><br><span class="line">	boolean flag = false;</span><br><span class="line"></span><br><span class="line">	public synchronized int get() &#123;</span><br><span class="line">		if (!flag) &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">				wait();</span><br><span class="line">			&#125; catch (InterruptedException e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(&quot;消费：&quot; + n);</span><br><span class="line">		flag = false;//消费完毕，容器中没有数据</span><br><span class="line">		notifyAll();</span><br><span class="line">		return n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public synchronized void set(int n) &#123;</span><br><span class="line">		if (flag) &#123;</span><br><span class="line">			try &#123;</span><br><span class="line">				wait();</span><br><span class="line">			&#125; catch (InterruptedException e) &#123;</span><br><span class="line"></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(&quot;生产：&quot; + n);</span><br><span class="line">		this.n = n;</span><br><span class="line">		flag = true;//生产完毕，容器中已经有数据</span><br><span class="line">		notifyAll();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Reflex"><a href="#Reflex" class="headerlink" title="Reflex"></a>Reflex</h3><ul>
<li>运行时动态访问类与对象<h4 id="Class-2"><a href="#Class-2" class="headerlink" title="Class"></a>Class</h4></li>
<li>代表”类和接口”的类</li>
<li>通过Class对象可获取对应类的构造方法&#x2F;方法&#x2F;成员变量</li>
<li>methods<ul>
<li>Class.forName()</li>
<li>classObj.newInstance()</li>
<li>classObj.getConstructor()</li>
<li>classObj.getMethod()</li>
<li>classObj.getField()<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//得到员工类的类对象</span><br><span class="line">Class employeeClass = Class.forName(&quot;com.ll.reflect.entity.Employee&quot;);</span><br><span class="line">//通过员工类默认构造方法创建Employee对象</span><br><span class="line">Employee employee = (Employee)employeeClass.newInstance();</span><br></pre></td></tr></table></figure>
<h4 id="Constructor"><a href="#Constructor" class="headerlink" title="Constructor"></a>Constructor</h4></li>
</ul>
</li>
<li>methods<ul>
<li>classObj.getConstructor(): get a public constructor object</li>
<li>constructorObj.newInstance()<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//得到员工类的类对象</span><br><span class="line">Class employeeClass = Class.forName(&quot;com.ll.reflect.entity.Employee&quot;);</span><br><span class="line">//得到Employee类包含四个参数的构造方法对象</span><br><span class="line">Constructor constructor = employeeClass.getConstructor(new Class[]&#123;</span><br><span class="line">              Integer.class,</span><br><span class="line">              String.class,</span><br><span class="line">              Float.class,</span><br><span class="line">              String.class</span><br><span class="line">            &#125;);</span><br><span class="line">//通过指定构造方法传入数据,创建对象</span><br><span class="line">Employee employee = (Employee) constructor.newInstance(new Object[]&#123;</span><br><span class="line">                      100,</span><br><span class="line">                      &quot;Liam Lian&quot;,</span><br><span class="line">                      3000f,</span><br><span class="line">                      &quot;Product&quot;&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Method-1"><a href="#Method-1" class="headerlink" title="Method"></a>Method</h4></li>
</ul>
</li>
<li>methods<ul>
<li>classObj.getMethod(): get a public method object</li>
<li>methodObj.invoke()<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Method method = employeeClass.getMethod(&quot;updateSalary&quot;, new Class[]&#123;Float.class&#125;);</span><br><span class="line">//执行方法,为Liam Lian上调薪资300元</span><br><span class="line">method.invoke(employee, new Object[]&#123;300f&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Field"><a href="#Field" class="headerlink" title="Field"></a>Field</h4></li>
</ul>
</li>
<li>methods<ul>
<li>classObj.getField(): get a public field object</li>
<li>fieldObj.set()</li>
<li>fieldObj.get()<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Field enameField = employeeClass.getField(&quot;ename&quot;);</span><br><span class="line">enameField.set(employee, &quot;Liam Lian&quot;);</span><br><span class="line">String ename = (String)enameField.get(employee);</span><br></pre></td></tr></table></figure>
<h4 id="getDeclared"><a href="#getDeclared" class="headerlink" title="getDeclared"></a>getDeclared</h4></li>
</ul>
</li>
<li>getDeclaredConstructor(s)|Method(s)|Field(s)获取对应对象<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import com.imooc.reflect.entity.Employee;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Constructor;</span><br><span class="line">import java.lang.reflect.Field;</span><br><span class="line">import java.lang.reflect.InvocationTargetException;</span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 获取对象所有成员变量值</span><br><span class="line"> */</span><br><span class="line">public class getDeclaredSample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Class employeeClass = Class.forName(&quot;com.imooc.reflect.entity.Employee&quot;);</span><br><span class="line">            Constructor constructor = employeeClass.getConstructor(new Class[]&#123;</span><br><span class="line">                    Integer.class, String.class, Float.class, String.class</span><br><span class="line">            &#125;);</span><br><span class="line">            Employee employee = (Employee) constructor.newInstance(new Object[]&#123;</span><br><span class="line">                    100, &quot;Liam Lian&quot;, 3000f, &quot;Product&quot;</span><br><span class="line">            &#125;);</span><br><span class="line">            //获取当前类所有成员变量</span><br><span class="line">            Field[] fields = employeeClass.getDeclaredFields();</span><br><span class="line">            for (Field field : fields)&#123;</span><br><span class="line">                if (field.getModifiers() == 1) &#123; //pubilc修饰</span><br><span class="line">                    Object val = field.get(employee);</span><br><span class="line">                    System.out.println(field.getName() + &quot;:&quot; + val);</span><br><span class="line">                &#125; else if (field.getModifiers() == 2) &#123; //private修饰</span><br><span class="line">                    String methodName = &quot;get&quot; + field.getName().substring(0,1).toUpperCase()</span><br><span class="line">                                        + field.getName().substring(1);</span><br><span class="line">                    Method getMethod = employeeClass.getMethod(methodName);</span><br><span class="line">                    Object ret = getMethod.invoke(employee);</span><br><span class="line">                    System.out.println(field.getName() + &quot;:&quot; + ret);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.UnsupportedEncodingException;</span><br><span class="line">import java.net.URLDecoder;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">public class Application &#123;</span><br><span class="line">    public static void say()&#123;</span><br><span class="line">        Properties properties = new Properties();</span><br><span class="line">        String configPath = Application.class.getResource(&quot;/config.properties&quot;).getPath();</span><br><span class="line">        try &#123;</span><br><span class="line">            configPath = new URLDecoder().decode(configPath, &quot;UTF-8&quot;);</span><br><span class="line">            properties.load(new FileInputStream(configPath));</span><br><span class="line">            String language = properties.getProperty(&quot;language&quot;);</span><br><span class="line">            I18N i18n = (I18N)Class.forName(language).newInstance();</span><br><span class="line">            System.out.println(i18n.say());</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Application.say();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Lambda-and-Functional-Programming"><a href="#Lambda-and-Functional-Programming" class="headerlink" title="Lambda and Functional Programming"></a>Lambda and Functional Programming</h3><ul>
<li>Lambda更简洁的实现匿名内部类与函数声明与调用</li>
<li>Collections.sort(names, (a,b) -&gt; {b.compareTo(a)});</li>
<li>函数式编程是基于函数式接口并使用lambda表达的编程方式; 理念是将代码作为可重用数据代入到程序运行中; 函数式接口是有且只有一个抽象方法的接口; @FunctionalInterface&#x2F;&#x2F;通知编译器这是函数式接口,进行抽象方法检查</li>
</ul>
<h4 id="JDK8-frequently-used"><a href="#JDK8-frequently-used" class="headerlink" title="JDK8 frequently used"></a>JDK8 frequently used</h4><ul>
<li><p>Consumer<T> 对应有一个输入参数无输出的功能代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import java.util.function.Consumer;</span><br><span class="line"></span><br><span class="line">public class ConsumerSample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        output(s-&gt; System.out.println(&quot;向控制台打印:&quot; + s));</span><br><span class="line">        output(s-&gt;&#123;</span><br><span class="line">            System.out.println(&quot;向XXX网站发送数据包:&quot; + s);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    public static void output(Consumer&lt;String&gt; consumer)&#123;</span><br><span class="line">        String text = &quot;天将降大任于是人也，必先苦其心志，劳其筋骨，饿其体肤，空乏其身，行拂乱其所为。&quot;;</span><br><span class="line">        consumer.accept(text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Function&lt;T,R&gt; 对应有一个输入参数且需要返回数据的功能代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Random;</span><br><span class="line">import java.util.function.Function;</span><br><span class="line"></span><br><span class="line">public class FunctionSample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Function&lt;Integer,String&gt; randomStringFunction = l -&gt; &#123;</span><br><span class="line">            String chars = &quot;abcdefghijklmnopqrstuvxwyz0123456789&quot;;</span><br><span class="line">            StringBuffer stringBuffer = new StringBuffer();</span><br><span class="line">            Random random = new Random();</span><br><span class="line">            for (int i = 0 ; i &lt; l ; i++) &#123;</span><br><span class="line">                int position = random.nextInt(chars.length());</span><br><span class="line">                stringBuffer.append(chars.charAt(position));</span><br><span class="line">            &#125;</span><br><span class="line">            return stringBuffer.toString();</span><br><span class="line">        &#125;;</span><br><span class="line">        String randomString = randomStringFunction.apply(32);</span><br><span class="line">        System.out.println(randomString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>Predicate<T> 用于条件判断,固定返回布尔值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.function.Predicate;</span><br><span class="line"></span><br><span class="line">public class PredicateSample &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Predicate&lt;Integer&gt; predicate = n-&gt;n&lt;4;</span><br><span class="line">        boolean result = predicate.test(10);</span><br><span class="line">        System.out.println(result);</span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; list = Arrays.asList(1,2,3,4,5,6,7,8,9,10);</span><br><span class="line">        filter(list,n-&gt;n%2==1); //取所有奇数</span><br><span class="line">        filter(list,n-&gt;n%2==0); //取所有偶数</span><br><span class="line">        filter(list,n-&gt;n&gt;5 &amp;&amp; n%2==0); //取所有大于5的偶数</span><br><span class="line">    &#125;</span><br><span class="line">    public static void filter(List&lt;Integer&gt; list , Predicate&lt;Integer&gt; predicate)&#123;</span><br><span class="line">        for (Integer num:list) &#123;</span><br><span class="line">            if (predicate.test(num)) &#123;</span><br><span class="line">                System.out.print(num + &quot; &quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//获取List集合中最大的偶数</span><br><span class="line">Optional&lt;Integer&gt; op = Arrays.asList(1,2,3,4,5,6).stream()</span><br><span class="line">.filter(x -&gt; x%2 == 0)</span><br><span class="line">.sorted((a,b) -&gt; b-a)</span><br><span class="line">.findFirst();</span><br><span class="line">System.out.println(op.get());</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import org.junit.Test;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Random;</span><br><span class="line">import java.util.stream.IntStream;</span><br><span class="line">import java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Stream流对象的五种创建方式</span><br><span class="line"> */</span><br><span class="line">public class StreamGenerator &#123;</span><br><span class="line">    //1.基于数组进行创建</span><br><span class="line">    @Test</span><br><span class="line">    public void generator1()&#123;</span><br><span class="line">        String[] arr = &#123;&quot;Lily&quot; , &quot;Andy&quot; , &quot;Jackson&quot; , &quot;Smith&quot;&#125;;</span><br><span class="line">        Stream&lt;String&gt; stream = Stream.of(arr);</span><br><span class="line">        stream.forEach(s-&gt;System.out.println(s));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //2.基于集合进行创建</span><br><span class="line">    @Test</span><br><span class="line">    public void generator2()&#123;</span><br><span class="line">        List&lt;String&gt; list = new ArrayList&lt;&gt;();</span><br><span class="line">        list.add(&quot;Lily&quot;);</span><br><span class="line">        list.add(&quot;Andy&quot;);</span><br><span class="line">        list.add(&quot;Jackson&quot;);</span><br><span class="line">        list.add(&quot;Smith&quot;);</span><br><span class="line">        Stream&lt;String&gt; stream = list.stream();</span><br><span class="line">        stream.forEach(s-&gt;System.out.println(s));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //3.利用generate方法创建无限长度流</span><br><span class="line">    @Test</span><br><span class="line">    public void generator3()&#123;</span><br><span class="line">        Stream&lt;Integer&gt; stream = Stream.generate(() -&gt; new Random().nextInt(100000));</span><br><span class="line">        stream.limit(10).forEach(i-&gt;System.out.println(i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //4.基于迭代器创建流</span><br><span class="line">    @Test</span><br><span class="line">    public void generator4()&#123;</span><br><span class="line">        Stream&lt;Integer&gt; stream = Stream.iterate(1, n-&gt;n+1);</span><br><span class="line">        stream.limit(100).forEach(i -&gt; System.out.println(i));</span><br><span class="line">    &#125;</span><br><span class="line">    //5.基于字符序列创建流</span><br><span class="line">    @Test</span><br><span class="line">    public void generator5()&#123;</span><br><span class="line">        String str = &quot;abcdefg我的&quot;;</span><br><span class="line">        IntStream stream = str.chars();</span><br><span class="line">        stream.forEach(c -&gt; System.out.println((char)c));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>forEach: 循环遍历</p>
</li>
<li><p>map: map 方法用于映射每个元素到对应的结果</p>
</li>
<li><p>filter: filter 方法用于通过设置的条件过滤出元素</p>
</li>
<li><p>limit: limit 方法用于获取指定数量的流</p>
</li>
<li><p>sorted: sorted 方法用于对流进行排序</p>
</li>
<li><p>Collectors: Collectors 类实现将流转换成集合和聚合元素</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line">public class StreamMethod &#123;</span><br><span class="line">    //提取集合中所有偶数并求和</span><br><span class="line">    @Test</span><br><span class="line">    public void case1()&#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot; , &quot;6&quot;);</span><br><span class="line">        int sum = list.stream() //获取stream对象</span><br><span class="line">            .mapToInt(s-&gt;Integer.parseInt(s)) //mapToInt将流中每一个数据转为整数</span><br><span class="line">            .filter(n-&gt;n%2==0) //filter对流数据进行过滤</span><br><span class="line">            .sum();//求和</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //所有名字首字母大写</span><br><span class="line">    @Test</span><br><span class="line">    public void case2()&#123;</span><br><span class="line">        List&lt;String&gt; list = Arrays.asList(&quot;lily&quot;,&quot;smith&quot;,&quot;jackson&quot;);</span><br><span class="line">        List newList = list.stream()</span><br><span class="line">                //按规则对每一个流数据进行转换</span><br><span class="line">                .map(s-&gt;s.substring(0,1).toUpperCase() + s.substring(1))</span><br><span class="line">                //.forEach(s-&gt; System.out.println(s));</span><br><span class="line">                //collect对流数据进行收集,生成新的List/Set</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">        System.out.println(newList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //将所有奇数从大到小进行排序,且不许出现重复</span><br><span class="line">    @Test</span><br><span class="line">    public void case3()&#123;</span><br><span class="line">        List&lt;Integer&gt; list = Arrays.asList(1,60,38,21,51,60,51,73);</span><br><span class="line">        List newList = list.stream().distinct()//去除重复的流数据</span><br><span class="line">            .filter(n-&gt;n%2==1)</span><br><span class="line">            .sorted((a,b)-&gt;b-a) //流数据排序</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">        System.out.println(newList);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Reg"><a href="#Reg" class="headerlink" title="Reg"></a>Reg</h3><ul>
<li>A: 精准匹配单个字符</li>
<li>x | y: 允许出现的2个字符</li>
<li>[xyz]: 字符集合,允许出现集合内任意单个字符 z c</li>
<li>[a-z], [A-Z], [0-9]</li>
<li>[^xyz], [^0-9]: 集合内字符不允许出现</li>
<li><code>\d</code> 匹配任意单个数字</li>
<li><code>\D</code> 匹配\d规则之外的任意单个字符</li>
<li><code>\w</code> 匹配任意单个字母数字下划线</li>
<li><code>\W</code> 匹配\w之外的任意单个字符</li>
<li><code>\s</code> 匹配单个空格</li>
<li><code>\n</code> 匹配单个换行符</li>
<li><code>.</code> 匹配任意单个字符(换行符除外)</li>
<li><code>\.</code> 特殊字符,只匹配.</li>
<li>A{3} 精准N次匹配</li>
<li>A{3,} 最少出现N次</li>
<li><code>\d&#123;3,5&#125;</code> 约定出现最少次数与最大次数</li>
<li><code>\d*</code> 可以出现零次至无限次,相当于{0,}</li>
<li><code>\d+</code> 最少出现一次,相当于{1,}</li>
<li><code>\d?</code> 最多出现一次,相当于{0,1}</li>
<li><code>^A.*</code> 头匹配</li>
<li><code>.*A$</code> 尾匹配</li>
<li><code>^A.*A$</code> 全字匹配</li>
<li>(ab){3}(cd){3}分组: abababcdcdcd</li>
</ul>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h3><ul>
<li>project manamgement tool</li>
<li>plug-in to export jar: maven-assembly-plugin<h4 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h4></li>
<li>mvn archetype:generate 创建Maven工程结构</li>
<li>mvn compile 编译源代码</li>
<li>mvn test 执行测试用例</li>
<li>mvn clean 清除产生的项目</li>
<li>mvn package 项目打包</li>
<li>mvn install 安装至本地仓库<h4 id="package"><a href="#package" class="headerlink" title="package"></a>package</h4>to do</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/07/MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/07/MySQL/" class="post-title-link" itemprop="url">MySQL</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-07 20:25:28" itemprop="dateCreated datePublished" datetime="2022-04-07T20:25:28-04:00">2022-04-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-16 18:47:48" itemprop="dateModified" datetime="2022-04-16T18:47:48-04:00">2022-04-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li>server layer + storage engine layer<ul>
<li><p>server layer</p>
<ul>
<li>connector: connects client to server; wait_timeout can decide how long it will wait before disconnecting if the client has not sent a query.</li>
<li>cache: After MySQL 8.0, not have this.</li>
<li>analyzer: lexical and syntax analysis</li>
<li>optimizer: which index to use, which table to be joined first</li>
<li>executor: execute; update binlog in disk<br>the server layer has functions, stored procedures, trigger, view, etc</li>
</ul>
</li>
<li><p>storage engine: store, update log</p>
<ul>
<li>engines: InnoDb, MyISAM, Memory, etc</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="data-types"><a href="#data-types" class="headerlink" title="data types"></a>data types</h2><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><ul>
<li>char: 255</li>
<li>varchar: 255, variable length</li>
<li>text: 65535<h2 id="Date-and-Time"><a href="#Date-and-Time" class="headerlink" title="Date and Time"></a>Date and Time</h2></li>
<li>Date</li>
<li>Datetime</li>
<li>Timestamp: converted from the current time zone to UTC for storage, and converted back from UTC to the current time zone for retrieval</li>
</ul>
<h2 id="Queries"><a href="#Queries" class="headerlink" title="Queries"></a>Queries</h2><p><img src="/../image/mysql/4.png" alt="undo log and read-view"></p>
<h3 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop database (if exists) database_name;</span><br><span class="line">create database database_name;</span><br><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<h3 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE database.table_na</span><br><span class="line">me (</span><br><span class="line">column1 datatype,</span><br><span class="line">column2 datatype,</span><br><span class="line">column3 datatype,</span><br><span class="line">....);</span><br><span class="line">drop table (if exists) database.table_name;</span><br><span class="line">CREATE TABLE database.new_table_name</span><br><span class="line">AS</span><br><span class="line">(SELECT column1, column2,...</span><br><span class="line">FROM existing_table_name</span><br><span class="line">WHERE ....);</span><br><span class="line"></span><br><span class="line">Show tables;</span><br><span class="line">describe table_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Operator"><a href="#Operator" class="headerlink" title="Operator"></a>Operator</h3><ul>
<li>&#x3D;</li>
<li>&lt;&gt;, !&#x3D;</li>
<li>is null, is not null</li>
<li>between and</li>
<li>in</li>
<li>EXISTS</li>
<li>like<ul>
<li>%: zero or more</li>
<li>_: single</li>
</ul>
</li>
</ul>
<h4 id="Priority"><a href="#Priority" class="headerlink" title="Priority"></a>Priority</h4><ul>
<li>() &gt; NOT &gt;And &gt; Or</li>
</ul>
<h3 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">INSERT INTO 表名 [(字段名 [,字段名] ...)] VALUES (值的列表);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INSERT INTO 表名 （字段名）</span><br><span class="line">SELECT 字段名或值</span><br><span class="line">FROM 表名</span><br><span class="line">WHERE 条件;</span><br><span class="line"></span><br><span class="line">INSERT INTO demo.goodsmaster</span><br><span class="line">(</span><br><span class="line">  itemnumber,</span><br><span class="line">  barcode,</span><br><span class="line">  goodsname,</span><br><span class="line">  specification,</span><br><span class="line">  unit,</span><br><span class="line">  price</span><br><span class="line">)</span><br><span class="line">VALUES</span><br><span class="line">(</span><br><span class="line">  4,</span><br><span class="line">  &#x27;0003&#x27;,</span><br><span class="line">  &#x27;尺子&#x27;,</span><br><span class="line">  &#x27;三角型&#x27;,</span><br><span class="line">  &#x27;把&#x27;,</span><br><span class="line">  5</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>can skip inserting some columns if null allowed or have default values</li>
<li>ON DUPLICATE: 假设我们要把门店 B 的商品数据，插入到门店 A 的商品表中去，如果有重复的商品编号，就用门店 B 的条码，替换门店 A 的条码，用门店 B 的商品名称，替换门店 A 的商品名称；如果没有重复的编号，就直接把门店 B 的商品数据插入到门店 A 的商品表中。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; SELECT *</span><br><span class="line">    -&gt; FROM demo.goodsmaster;</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">| itemnumber | barcode | goodsname | specification | unit | salesprice |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">|          1 | 0001    | 书        | 16开          | 本   |      89.00 |</span><br><span class="line">|          2 | 0002    | 笔        | 10支装        | 包   |       5.00 |</span><br><span class="line">|          3 | 0003    | 橡皮      | NULL          | 个   |       3.00 |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT *</span><br><span class="line">    -&gt; FROM demo.goodsmaster1;</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">| itemnumber | barcode | goodsname | specification | unit | salesprice |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">|          1 | 0001    | 教科书    | NULL          | NULL |      89.00 |</span><br><span class="line">|          4 | 0004    | 馒头      |               |      |       1.50 |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INSERT INTO demo.goodsmaster</span><br><span class="line">SELECT *</span><br><span class="line">FROM demo.goodsmaster1 as a</span><br><span class="line">ON DUPLICATE KEY UPDATE barcode = a.barcode,goodsname=a.goodsname;</span><br><span class="line">-- 运行结果如下</span><br><span class="line">mysql&gt; SELECT *</span><br><span class="line">    -&gt; FROM demo.goodsmaster;</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">| itemnumber | barcode | goodsname | specification | unit | salesprice |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">|          1 | 0001    | 教科书    | 16开          | 本   |      89.00 |</span><br><span class="line">|          2 | 0002    | 笔        | 10支装        | 包   |       5.00 |</span><br><span class="line">|          3 | 0003    | 橡皮      | NULL          | 个   |       3.00 |</span><br><span class="line">|          4 | 0004    | 馒头      |               |      |       1.50 |</span><br><span class="line">+------------+---------+-----------+---------------+------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE FROM 表名</span><br><span class="line">WHERE 条件</span><br><span class="line"></span><br><span class="line">// 删除全部数据</span><br><span class="line">DELETE FROM demo.goodsmaster; // undo log</span><br><span class="line">Truncate table table_name; // no in undo log</span><br></pre></td></tr></table></figure>

<h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">UPDATE 表名</span><br><span class="line">SET 字段名=值</span><br><span class="line">WHERE 条件</span><br></pre></td></tr></table></figure>
<ul>
<li>Don’t update primary key</li>
</ul>
<h3 id="Read"><a href="#Read" class="headerlink" title="Read"></a>Read</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SELECT *|字段列表</span><br><span class="line">FROM 数据源</span><br><span class="line">WHERE 条件</span><br><span class="line">GROUP BY 字段</span><br><span class="line">HAVING 条件</span><br><span class="line">ORDER BY 字段</span><br><span class="line">LIMIT 起始点，行数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    [ALL | DISTINCT | DISTINCTROW ]</span><br><span class="line">    [HIGH_PRIORITY]</span><br><span class="line">    [STRAIGHT_JOIN]</span><br><span class="line">    [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]</span><br><span class="line">    [SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]</span><br><span class="line">    select_expr [, select_expr] ...</span><br><span class="line">    [into_option]</span><br><span class="line">    [FROM table_references</span><br><span class="line">      [PARTITION partition_list]]</span><br><span class="line">    [WHERE where_condition]</span><br><span class="line">    [GROUP BY &#123;col_name | expr | position&#125;, ... [WITH ROLLUP]]</span><br><span class="line">    [HAVING where_condition]</span><br><span class="line">    [WINDOW window_name AS (window_spec)</span><br><span class="line">        [, window_name AS (window_spec)] ...]</span><br><span class="line">    [ORDER BY &#123;col_name | expr | position&#125;</span><br><span class="line">      [ASC | DESC], ... [WITH ROLLUP]]</span><br><span class="line">    [LIMIT &#123;[offset,] row_count | row_count OFFSET offset&#125;]</span><br><span class="line">    [into_option]</span><br><span class="line">    [FOR &#123;UPDATE | SHARE&#125;</span><br><span class="line">        [OF tbl_name [, tbl_name] ...]</span><br><span class="line">        [NOWAIT | SKIP LOCKED]</span><br><span class="line">      | LOCK IN SHARE MODE]</span><br><span class="line">    [into_option]</span><br><span class="line"></span><br><span class="line">into_option: &#123;</span><br><span class="line">    INTO OUTFILE &#x27;file_name&#x27;</span><br><span class="line">        [CHARACTER SET charset_name]</span><br><span class="line">        export_options</span><br><span class="line">  | INTO DUMPFILE &#x27;file_name&#x27;</span><br><span class="line">  | INTO var_name [, var_name] ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Windows<ul>
<li>window functions also operate on a subset of rows but they do not reduce the number of rows returned by the query<br>···<br>window_function_name(expression) OVER (<br> [PARTITION BY <expression>[{,<expression>…}]]<br> [ORDER BY <expression> [ASC|DESC], [{,<expression>…}]] &#x2F;&#x2F; how the rows are ordered within a partition<br> [frame_unit {<frame_start>|<frame_between>}]<br>)</li>
</ul>
</li>
</ul>
<p>&#x2F;&#x2F; running total<br>SUM(total_price) OVER(ORDER BY Sales_Date rows between UNBOUNDED PRECEDING and current row) AS Running_Total<br>···</p>
<ul>
<li><p>A frame is defined with respect to the current row, which allows a frame to move within a partition depending on the position of the current row within its partition.</p>
</li>
<li><p>The frame unit specifies the type of relationship between the current row and frame rows. It can be ROWS or RANGE. The offsets of the current row and frame rows are the row numbers if the frame unit is ROWS and row values the frame unit is RANGE.</p>
</li>
<li><p>The frame_start defines the frame boundary and contains one of the following:</p>
<ul>
<li>UNBOUNDED PRECEDING: frame starts at the first row of the partition.</li>
<li>N PRECEDING: a physical N of rows before the first current row. N can be a literal number or an expression that evaluates to a number.</li>
<li>CURRENT ROW: the row of the current calculation</li>
</ul>
</li>
<li><p>The frame_between defines the frame boundary and is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETWEEN frame_boundary_1 AND frame_boundary_2   </span><br></pre></td></tr></table></figure>
<p>The frame_boundary_1 and frame_boundary_2 can each contain one of the following:</p>
<ul>
<li>frame_start: as mentioned previously.</li>
<li>UNBOUNDED FOLLOWING: the frame ends at the final row in the partition.</li>
<li>N FOLLOWING: a physical N of rows after the current row.</li>
</ul>
</li>
<li><p>If you don’t specify the frame_definition in the OVER clause, then MySQL uses the following frame by default:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</span><br></pre></td></tr></table></figure>
<p>  <img src="/../image/mysql/5.png" alt="windows function"></p>
</li>
<li><p>Aggregate: Count, Sum, Avg, Min, Max</p>
</li>
<li><p>Offset:</p>
<ul>
<li>first_value(column_name)</li>
<li>last_value(column_name)</li>
<li>lead(<expression>[,offset[, default_value]]): running diff, e.g. y-o-y; If offset is zero, then the LAG() function evaluates the expression for the current row. If you don’t specify the offset, then the LAG() function uses one by default.</li>
<li>lag(<expression>[,offset[, default_value]]): running diff, e.g. y-o-y</li>
</ul>
</li>
<li><p>Rank</p>
<ul>
<li>row_number: Assigns a sequential integer to every row within its partition; application: Removing duplicate rows</li>
<li>rank</li>
<li>dense_rank</li>
</ul>
</li>
</ul>
<ul>
<li><p>distinct</p>
<ul>
<li>If you have null value in the column, select distinct will only show one null value</li>
<li>Select multiple columns: MySQL uses the combination of values in these columns to determine the uniqueness of the row in the result set</li>
</ul>
</li>
<li><p>Use of an unqualified * with other items in the select list may produce a parse error. To avoid this problem, use a qualified tbl_name.* reference:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT AVG(score), t1.* FROM t1 ...</span><br></pre></td></tr></table></figure></li>
<li><p>You need not specify a tbl_name or db_name.tbl_name prefix for a column reference unless the reference would be ambiguous.</p>
</li>
<li><p>The INTO clause, if present, can appear in any position indicated by the syntax description, but within a given statement can appear only once, not in multiple positions.</p>
</li>
<li><p>column alias:</p>
</li>
</ul>
<ul>
<li>it is good practice to be in the habit of using AS explicitly when specifying column aliases.</li>
<li>can be used in GROUP BY, ORDER BY, or HAVING clauses</li>
<li>If the column alias contains spaces, you need to place it inside quotes</li>
<li>The execute order after select can use the alias name, otherwise no. It is not permissible to refer to a column alias in a WHERE clause, because the column value might not yet be determined when the WHERE clause is executed.<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CONCAT(&#x27;Jane&#x27;,&#x27; &#x27;,&#x27;Doe&#x27;) AS &#x27;Full name&#x27;;</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li>from: table, derived table<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tbl_name [[AS] alias] [index_hint]</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li>devrived table must have an alias</li>
<li>If you name more than one table, you are performing a join.</li>
<li>The use of index hints provides the optimizer with information about how to choose indexes during query processing. For a description of the syntax for specifying these hints, see Section 8.9.4, “Index Hints”.You can use SET max_seeks_for_key&#x3D;value as an alternative way to force MySQL to prefer key scans instead of table scans. See Section 5.1.8, “Server System Variables”.</li>
</ul>
<ul>
<li><p>GROUP BY</p>
<ul>
<li>permits a WITH ROLLUP modifier. See Section 12.20.2, “GROUP BY Modifiers”.<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    productLine,</span><br><span class="line">    orderYear,</span><br><span class="line">    SUM(orderValue) totalOrderValue</span><br><span class="line">FROM</span><br><span class="line">    sales</span><br><span class="line">GROUP BY</span><br><span class="line">    productline,</span><br><span class="line">    orderYear</span><br><span class="line">WITH ROLLUP;</span><br></pre></td></tr></table></figure>
<img src="/../image/mysql/6.png" alt="with rollup"><br><a target="_blank" rel="noopener" href="https://www.mysqltutorial.org/mysql-rollup/">https://www.mysqltutorial.org/mysql-rollup/</a></li>
<li>The number of dimension column you selected can not larger than that of followed by clause group by</li>
</ul>
</li>
<li><p>order by</p>
<ul>
<li>asc, desc</li>
<li>If ORDER BY occurs within a parenthesized query expression and also is applied in the outer query, the results are undefined and may change in a future version of MySQL.</li>
<li>When you use ORDER BY or GROUP BY to sort a column in a SELECT, the server sorts values using only the initial number of bytes indicated by the max_sort_length system variable.</li>
</ul>
</li>
<li><p>limit:</p>
</li>
</ul>
<ul>
<li>start index is 0</li>
<li><code>limit 1, 2</code>: 1 means starting from 1 (included, first row is 0); 2 means 2 records</li>
<li>With one argument, the value specifies the number of rows to return from the beginning of the result set</li>
<li>For prepared statements, you can use placeholders. <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET @skip=1; SET @numrows=5;</span><br><span class="line">PREPARE STMT FROM &#x27;SELECT * FROM tbl LIMIT ?, ?&#x27;;</span><br><span class="line">EXECUTE STMT USING @skip, @numrows;</span><br></pre></td></tr></table></figure></li>
<li>If LIMIT occurs within a parenthesized query expression and also is applied in the outer query, the results are undefined and may change in a future version of MySQL</li>
</ul>
<ul>
<li><p>HAVING</p>
<ul>
<li>The query result includes only groups satisfying the HAVING conditions. (If no GROUP BY is present, all rows implicitly form a single aggregate group.)</li>
<li>The WHERE clause specifies conditions on columns in the select list, but cannot refer to aggregate functions.</li>
<li>SQL standard: HAVING must reference only columns in the GROUP BY clause or columns used in aggregate functions. Extension: permits HAVING to refer to columns in the SELECT list and columns in outer subqueries. If a HAVING column name is used both in GROUP BY and as an aliased column in the select column list, preference is given to the column in the GROUP BY column</li>
</ul>
</li>
<li><p>aggregation function</p>
</li>
</ul>
<ul>
<li>AVG: ignore null</li>
<li>COUNT<ul>
<li>COUNT(*) to count the number of rows in a table</li>
<li>COUNT(column) ignores NULL values</li>
</ul>
</li>
<li>MAX: ignore null</li>
<li>MIN: ignore null</li>
<li>SUM: ignore null</li>
<li>for each group</li>
<li>can put <code>Distinct</code> inside (), such as <code>count(DISTINCT prod_price)</code></li>
</ul>
<ul>
<li>For update: …</li>
<li>DISTINCT</li>
<li>STRAIGHT_JOIN forces the optimizer to join the tables in the order in which they are listed in the FROM clause.</li>
<li>STRAIGHT_JOIN does not apply to any table that the optimizer treats as a const or system table.</li>
<li>SQL_BIG_RESULT or SQL_SMALL_RESULT can be used with GROUP BY or DISTINCT to tell the optimizer that the result set has many rows or is small, respectively. For SQL_BIG_RESULT, MySQL directly uses disk-based temporary tables if they are created, and prefers sorting to using a temporary table with a key on the GROUP BY elements. For SQL_SMALL_RESULT, MySQL uses in-memory temporary tables to store the resulting table instead of using sorting. This should not normally be needed.</li>
<li>SQL_BUFFER_RESULT forces the result to be put into a temporary table. This helps MySQL free the table locks early and helps in cases where it takes a long time to send the result set to the client. This modifier can be used only for top-level SELECT statements, not for subqueries or following UNION.</li>
<li>Named Windows: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/window-functions-named-windows.html">https://dev.mysql.com/doc/refman/8.0/en/window-functions-named-windows.html</a></li>
<li>Partition: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/partitioning-selection.html">https://dev.mysql.com/doc/refman/8.0/en/partitioning-selection.html</a></li>
</ul>
<h3 id="Join"><a href="#Join" class="headerlink" title="Join"></a>Join</h3><ul>
<li>inner join</li>
<li>left join, right join<ul>
<li>If there is no match, the columns of the row from the right&#x2F;left table will contain NULL</li>
</ul>
</li>
<li>Full (outer) Join<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM t1</span><br><span class="line">LEFT JOIN t2 ON t1.id = t2.id</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT * FROM t1</span><br><span class="line">RIGHT JOIN t2 ON t1.id = t2.id</span><br><span class="line">WHERE t1.id IS NULL</span><br></pre></td></tr></table></figure></li>
<li>cross join</li>
<li>self join</li>
</ul>
<h3 id="Case-when"><a href="#Case-when" class="headerlink" title="Case when"></a>Case when</h3><p>···<br>CASE WHEN [compare_value] THEN result<br>[WHEN [compare_value] THEN result …]<br>[ELSE result] END (AS new_column)<br>···</p>
<ul>
<li>CASE WHEN case be used in any statement</li>
</ul>
<h3 id="union"><a href="#union" class="headerlink" title="union"></a>union</h3><ul>
<li>union removes duplicates</li>
<li>union all</li>
<li>only one order by statement can be used, which is after the final select statement</li>
</ul>
<h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><h3 id="common-table-expression-or-CTE"><a href="#common-table-expression-or-CTE" class="headerlink" title="common table expression or CTE"></a>common table expression or CTE</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">WITH salesrep AS (</span><br><span class="line">    SELECT</span><br><span class="line">        employeeNumber,</span><br><span class="line">        CONCAT(firstName, &#x27; &#x27;, lastName) AS salesrepName</span><br><span class="line">    FROM</span><br><span class="line">        employees</span><br><span class="line">    WHERE</span><br><span class="line">        jobTitle = &#x27;Sales Rep&#x27;</span><br><span class="line">),</span><br><span class="line">customer_salesrep AS (</span><br><span class="line">    SELECT</span><br><span class="line">        customerName, salesrepName</span><br><span class="line">    FROM</span><br><span class="line">        customers</span><br><span class="line">            INNER JOIN</span><br><span class="line">        salesrep ON employeeNumber = salesrepEmployeeNumber</span><br><span class="line">)</span><br><span class="line">SELECT</span><br><span class="line">    *</span><br><span class="line">FROM</span><br><span class="line">    customer_salesrep</span><br><span class="line">ORDER BY customerName;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WITH RECURSIVE cte_name AS (</span><br><span class="line">    initial_query  -- anchor member</span><br><span class="line">    UNION ALL</span><br><span class="line">    recursive_query -- recursive member that references to the CTE name</span><br><span class="line">)</span><br><span class="line">SELECT * FROM cte_name;</span><br></pre></td></tr></table></figure>
<p>to do: <a target="_blank" rel="noopener" href="https://www.mysqltutorial.org/mysql-recursive-cte/">https://www.mysqltutorial.org/mysql-recursive-cte/</a></p>
<h3 id="Execution-Order"><a href="#Execution-Order" class="headerlink" title="Execution Order"></a>Execution Order</h3><p>From &gt; join &gt; Where &gt; group by &gt; having &gt; select &gt; distinct &gt; order by &gt; limit</p>
<h3 id="Prepared-statement"><a href="#Prepared-statement" class="headerlink" title="Prepared statement"></a>Prepared statement</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM products</span><br><span class="line">WHERE productCode = ?;</span><br></pre></td></tr></table></figure>
<ul>
<li>When MySQL executes this query with different productcode values, it does not have to fully parse the query. As a result, this helps MySQL execute the query faster, especially when MySQL executes the same query multiple times.</li>
<li>Since the prepared statement uses placeholders (?), this helps avoid many variants of SQL injection hence make your application more secure.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PREPARE stmt1 FROM</span><br><span class="line">	&#x27;SELECT</span><br><span class="line">   	    productCode,</span><br><span class="line">            productName</span><br><span class="line">	FROM products</span><br><span class="line">        WHERE productCode = ?&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SET @pc = &#x27;S10_1678&#x27;;</span><br><span class="line"></span><br><span class="line">EXECUTE stmt1 USING @pc;</span><br><span class="line"></span><br><span class="line">DEALLOCATE PREPARE stmt1;</span><br></pre></td></tr></table></figure>

<h2 id="Constraint"><a href="#Constraint" class="headerlink" title="Constraint"></a>Constraint</h2><h3 id="PK-vs-FK"><a href="#PK-vs-FK" class="headerlink" title="PK vs FK"></a>PK vs FK</h3><ul>
<li>PK<ul>
<li>unique</li>
<li>not null</li>
<li>one but can be multiple columns</li>
</ul>
</li>
<li>FK<ul>
<li>primary key in another table</li>
<li>can be null</li>
<li>can have more than one FK</li>
</ul>
</li>
</ul>
<h2 id="View"><a href="#View" class="headerlink" title="View"></a>View</h2><ul>
<li>read-only, no storage</li>
</ul>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><h3 id="Redo-Log-in-InnoDB"><a href="#Redo-Log-in-InnoDB" class="headerlink" title="Redo Log in InnoDB"></a>Redo Log in InnoDB</h3><ul>
<li>Write-ahead logging<ul>
<li>write to redo log, update memory, then disk</li>
<li>when the redo log is full, move to disk to clean some space</li>
</ul>
</li>
<li>Crash-safe: innodb_flush_log_at_trx_commit &#x3D; 1<h3 id="binlog-in-the-server-layer"><a href="#binlog-in-the-server-layer" class="headerlink" title="binlog in the server layer"></a>binlog in the server layer</h3></li>
<li>can be used by all engines</li>
<li>Has statement-based logging: Events contain SQL statements that produce data changes (inserts, updates, deletes)</li>
<li>append</li>
<li>sync_binlog &#x3D; 1 to make sure binlog is not lost</li>
</ul>
<p>InnoDB prepares redo log. Executor updates binlog. InnoDB commits redo log.</p>
<h3 id="Undo-log"><a href="#Undo-log" class="headerlink" title="Undo log"></a>Undo log</h3><ul>
<li><p>When there are no read-views earlier than this undo log record, it will be deleted.<br><img src="/../image/mysql/2.webp" alt="undo log and read-view"><br>Source: <a target="_blank" rel="noopener" href="https://time.geekbang.org/column/article/68963">https://time.geekbang.org/column/article/68963</a></p>
</li>
<li><p>Long transaction will cause too many undo log records to stay</p>
</li>
<li><p>To avoid long transaction, set autocommit&#x3D;1</p>
</li>
<li><p>To find long transaction (e.g. 60s):</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60</span><br></pre></td></tr></table></figure>
<ul>
<li>Analyze general log to avoid long transaction issues</li>
<li>SET_MAX_EXECUTION_TIME</li>
</ul>
<h3 id="How-to-restore"><a href="#How-to-restore" class="headerlink" title="How to restore"></a>How to restore</h3><ul>
<li>Find the most recent full backup. Then based on binlog records later than the most recent full backup, restore data.</li>
<li>back up every day or every week? More frequent, more storage, less RTO(Recovery Time Objective).</li>
</ul>
<h2 id="Transaction"><a href="#Transaction" class="headerlink" title="Transaction"></a>Transaction</h2><ul>
<li>high isolation will lead to low efficiency<h3 id="Isolation-Levels"><a href="#Isolation-Levels" class="headerlink" title="Isolation Levels"></a>Isolation Levels</h3></li>
<li>read uncommitted: no read-view.</li>
<li>read committed: a read-view is created when a SQL query executes</li>
<li>repeatable read: a read-view is created when the transaction starts , so data seen in this transaction are the same as what they were when this transaction started.</li>
<li>serializable: read and write will add lock. After a transaction finishes, another transaction can execute.<br><img src="/../image/mysql/1.webp" alt="isolation levels"><br>Source: <a target="_blank" rel="noopener" href="https://time.geekbang.org/column/article/68963">https://time.geekbang.org/column/article/68963</a></li>
</ul>
<h2 id="index"><a href="#index" class="headerlink" title="index"></a>index</h2><ul>
<li>different storage engines may have different index implementation.<h3 id="InnoDB-index-model"><a href="#InnoDB-index-model" class="headerlink" title="InnoDB index model"></a>InnoDB index model</h3></li>
<li>B+ tree<br><img src="/../image/mysql/3.webp" alt="InnoDB index model"></li>
<li>primary key index (called clustered index in InnoDB): leaves store records</li>
<li>non primary key index (called secondary index in InnoDB): leaves store primary key values. If search based on non primary key index, will search the B+ tree of the non primary key index first, find the primary key value, and then search the B+ tree of the primary key index.</li>
<li>index maintenance<ul>
<li>inserting may cause some records to be moved</li>
<li>if a data page is full, inserting will create a new data page</li>
</ul>
</li>
<li>Usually using auto increment as the primary key leads to better performance and less storage. However, for the k-v situation, may use a business column as the primary key</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/04/07/Design-Pattern/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/07/Design-Pattern/" class="post-title-link" itemprop="url">Design Pattern</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-07 17:51:29" itemprop="dateCreated datePublished" datetime="2022-04-07T17:51:29-04:00">2022-04-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-13 16:00:27" itemprop="dateModified" datetime="2022-04-13T16:00:27-04:00">2022-04-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Code-Quality"><a href="#Code-Quality" class="headerlink" title="Code Quality"></a>Code Quality</h2><ul>
<li>maintainability: quickly update without bugs<ul>
<li>well layered</li>
<li>modularity</li>
<li>high cohesion loose coupling</li>
<li>well-documented</li>
<li>interface-oriented programming</li>
</ul>
</li>
<li>readability</li>
<li>extensibility</li>
<li>simplicity</li>
<li>reusability<ul>
<li>inheritance, polymorphism</li>
<li>SRP</li>
<li>high cohesion loose coupling</li>
<li>modularity</li>
</ul>
</li>
<li>testability</li>
</ul>
<h2 id="Paradigm"><a href="#Paradigm" class="headerlink" title="Paradigm"></a>Paradigm</h2><ul>
<li>Process-oriented programming: a process is a unit, featuring separation of data structures and methods.</li>
<li>Object-oriented programming: based on class and object. Data structures and methods are in a class.   </li>
<li>Functional programming</li>
</ul>
<h3 id="OOP"><a href="#OOP" class="headerlink" title="OOP"></a>OOP</h3><h4 id="Four-features"><a href="#Four-features" class="headerlink" title="Four features"></a>Four features</h4><ul>
<li>encapsulation: control how to access (get and set) and hide details</li>
</ul>
<ul>
<li>to increase maintainability</li>
</ul>
<ul>
<li><p>abstraction: hide details of implementation and only expose what to do</p>
<ul>
<li>may use <code>interface</code>, <code>abstract</code>, or function</li>
<li>when naming a function, avoid implementation details. E.g. <code>getPictureUrl()</code> is better than <code>getAWSPictureUrl()</code> is bad, in case later we change AWS to something else</li>
<li>to increase maintainability and extensibility</li>
</ul>
</li>
<li><p>inheritance: is-a, e.g. dog is an animal</p>
<ul>
<li>Java: a class can only extend a superclass rater than multiple superclasses</li>
<li>to increase reusability</li>
<li>if there are too many inheritance layers, maintainability and readability suffer</li>
</ul>
</li>
<li><p>polymorphism: a subclass can replace a superclass</p>
<ul>
<li>override</li>
<li>to increase extensibility and reusability</li>
</ul>
</li>
</ul>
<h4 id="Compared-to-Process-oriented-Programming"><a href="#Compared-to-Process-oriented-Programming" class="headerlink" title="Compared to Process-oriented Programming"></a>Compared to Process-oriented Programming</h4><p>pros:</p>
<ul>
<li>complex application, not linear but like a network</li>
<li>modularity</li>
<li>four features</li>
<li>think like a human</li>
</ul>
<h4 id="Fake-OOP"><a href="#Fake-OOP" class="headerlink" title="Fake OOP"></a>Fake OOP</h4><ul>
<li>add unnecessary getter and setter</li>
<li>the getter returns an object, which may be modified unintendedly. Can use <code>Collections.unmodifiableList()</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCart</span> &#123;</span><br><span class="line">  <span class="comment">// ...other codes...</span></span><br><span class="line">  <span class="keyword">public</span> List&lt;ShoppingCartItem&gt; <span class="title function_">getItems</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Collections.unmodifiableList(<span class="built_in">this</span>.items);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnmodifiableList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">UnmodifiableCollection</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt; &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...other codes...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ShoppingCart</span> <span class="variable">cart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line">List&lt;ShoppingCartItem&gt; items = cart.getItems();</span><br><span class="line">items.clear();<span class="comment">//will throw UnsupportedOperationException</span></span><br></pre></td></tr></table></figure>

<ul>
<li>global variable and method<ul>
<li>singleton</li>
<li>static attribute</li>
<li>static method: used to manipulate static attribute or data outside</li>
<li>constant: can put config attributes in a class <code>Constants</code></li>
</ul>
</li>
</ul>
<h5 id="POP-example-Constants"><a href="#POP-example-Constants" class="headerlink" title="POP example: Constants"></a>POP example: Constants</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Constants &#123;</span><br><span class="line">  public static final String MYSQL_ADDR_KEY = &quot;mysql_addr&quot;;</span><br><span class="line">  public static final String MYSQL_DB_NAME_KEY = &quot;db_name&quot;;</span><br><span class="line">  public static final String MYSQL_USERNAME_KEY = &quot;mysql_username&quot;;</span><br><span class="line">  public static final String MYSQL_PASSWORD_KEY = &quot;mysql_password&quot;;</span><br><span class="line"></span><br><span class="line">  public static final String REDIS_DEFAULT_ADDR = &quot;192.168.7.2:7234&quot;;</span><br><span class="line">  public static final int REDIS_DEFAULT_MAX_TOTAL = 50;</span><br><span class="line">  public static final int REDIS_DEFAULT_MAX_IDLE = 50;</span><br><span class="line">  public static final int REDIS_DEFAULT_MIN_IDLE = 20;</span><br><span class="line">  public static final String REDIS_DEFAULT_KEY_PREFIX = &quot;rt:&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Using a single Constants may be bad because:</p>
<ul>
<li>when there are too many lines, hard to find one and may conflict with others</li>
<li>long compilation time. Each time <code>Constants</code> is changed, other classes depend on that will be compiled again. When the project is large and we need to do unit test, it will take long.</li>
<li>reusability. If we need to use only some variables in  <code>Constants</code> in another project, we have to import the whole file, which is a waste.</li>
</ul>
<p> How to improve?</p>
<ul>
<li>method 1: Break down  <code>Constants</code> into <code>MysqlConstants</code>, <code>RedisConstants</code>, etc</li>
<li>method 2: put constant in the class that uses it. E.g.  <code>RedisConfig</code> class</li>
</ul>
<h5 id="POP-example-Utils"><a href="#POP-example-Utils" class="headerlink" title="POP example: Utils"></a>POP example: Utils</h5><p>Class A and class B use the same methods. To avoid repetition, we put it in <code>XxxUtils</code>. Use static methods.</p>
<h5 id="POP-example-VO-x2F-BO-x2F-Entity-and-Controller-x2F-Service-x2F-Repository"><a href="#POP-example-VO-x2F-BO-x2F-Entity-and-Controller-x2F-Service-x2F-Repository" class="headerlink" title="POP example: VO&#x2F;BO&#x2F;Entity and Controller&#x2F;Service&#x2F;Repository"></a>POP example: VO&#x2F;BO&#x2F;Entity and Controller&#x2F;Service&#x2F;Repository</h5><ul>
<li>Anemic Demain Model: separation of data and logic<ul>
<li>Entity and Repository</li>
<li>BO and Service</li>
<li>VO and Controller</li>
</ul>
</li>
<li>Rich Demain Model: data and logic are in the same class. Service layer includes service classes and domain classes (similar to BO). 贫血模式重Service轻BO，充血模式轻Service重Domain。适合业务复杂，improve reusability.</li>
</ul>
<h4 id="Interface-vs-Abstract-Class"><a href="#Interface-vs-Abstract-Class" class="headerlink" title="Interface vs Abstract Class"></a>Interface vs Abstract Class</h4><h5 id="Abstract-Class"><a href="#Abstract-Class" class="headerlink" title="Abstract Class"></a>Abstract Class</h5><ul>
<li>is-a</li>
<li>抽象类不允许被实例化，只能被继承</li>
<li>抽象类可以包含属性和方法。方法既可以包含代码实现（比如 Logger 中的 log() 方法），也可以不包含代码实现（比如 Logger 中的 doLog() 方法）。不包含代码实现的方法叫作抽象方法。</li>
<li>子类继承抽象类，必须实现抽象类中的所有抽象方法。<h5 id="interface"><a href="#interface" class="headerlink" title="interface"></a>interface</h5></li>
<li>has a, contract</li>
<li>接口不能包含属性（也就是成员变量）。</li>
<li>接口只能声明方法，方法不能包含代码实现。</li>
<li>类实现接口的时候，必须实现接口中声明的所有方法。</li>
</ul>
<h4 id="Program-to-interface"><a href="#Program-to-interface" class="headerlink" title="Program to interface"></a>Program to interface</h4><p>Program to an interface, not an implementation</p>
<h4 id="SOLID-principles"><a href="#SOLID-principles" class="headerlink" title="SOLID principles"></a>SOLID principles</h4><ul>
<li>Single Responsibility Principle: A class or module should have a single responsibility. Whether the module is too big depends on the situation. At the beginning, can have a big module. Later when the module becomes too big, we can break it down. Usually should be less than 200 lines and 10 members.</li>
<li>Open Closed Principle: software entities (modules, classes, functions, etc.) should be open for extension , but closed for modification. 没有破坏原有代码的正常运行和单元测试。时刻具备扩展意识、抽象意识、封装意识。在识别出代码可变部分和不可变部分之后，我们要将可变部分封装起来，隔离变化，提供抽象化的不可变接口，给上层系统使用。当具体的实现发生变化的时候，我们只需要基于相同的抽象接口，扩展一个新的实现，替换掉老的实现即可，上游系统的代码几乎不需要修改。多态、依赖注入、基于接口而非实现编程。</li>
</ul>
<p>最合理的做法是，对于一些比较确定的、短期内可能就会扩展，或者需求改动对代码结构影响比较大的情况，或者实现成本不高的扩展点，在编写代码的时候之后，我们就可以事先做些扩展性设计。但对于一些不确定未来是否要支持的需求，或者实现起来比较复杂的扩展点，我们可以等到有需求驱动的时候，再通过重构代码的方式来支持扩展的需求。</p>
<p>在扩展性和可读性之间做权衡</p>
<ul>
<li><p>Liskov Substitution Principle: Functions that use pointers of references to base classes must be able to use objects of derived classes without knowing it<br>子类在设计的时候，要遵守父类的行为约定（或者叫协议）。父类定义了函数的行为约定，那子类可以改变函数的内部实现逻辑，但不能改变函数原有的行为约定。这里的行为约定包括：函数声明要实现的功能；对输入、输出、异常的约定；甚至包括注释中所罗列的任何特殊说明。实际上，定义中父类和子类之间的关系，也可以替换成接口和实现类之间的关系。</p>
</li>
<li><p>Interface Segregation Principle: Clients should not be forced to depend upon interfaces that they do not use</p>
</li>
<li><p>Dependency Inversion Principle: High-level modules shouldn’t depend on low-level modules. Both modules should depend on abstractions. In addition, abstractions shouldn’t depend on details. Details depend on abstractions.调用者属于高层，被调用者属于低层。</p>
</li>
</ul>
<p>“控制”指的是对程序执行流程的控制，而“反转”指的是在没有使用框架之前，程序员自己控制整个程序的执行。在使用框架之后，整个程序的执行流程通过框架来控制。流程的控制权从程序员“反转”给了框架。</p>
<p>依赖注入和控制反转恰恰相反，它是一种具体的编码技巧。我们不通过 new 的方式在类内部创建依赖类的对象，而是将依赖的类对象在外部创建好之后，通过构造函数、函数参数等方式传递（或注入）给类来使用。</p>
<h2 id="Design-Pattern"><a href="#Design-Pattern" class="headerlink" title="Design Pattern"></a>Design Pattern</h2><h3 id="Singleton"><a href="#Singleton" class="headerlink" title="Singleton"></a>Singleton</h3><ul>
<li>create and provide only one instance by itself</li>
<li>implementation<ul>
<li>private constructor</li>
<li>private static object</li>
<li>public static method to create and get</li>
</ul>
</li>
<li>type<ul>
<li>hungry: Instantiate when loading the class; thread-safe  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    //饿汉式：创建对象实例的时候直接初始化  空间换时间</span><br><span class="line">public class SingletonOne &#123;</span><br><span class="line">	//1、创建类中私有构造</span><br><span class="line">	private SingletonOne()&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	//2、创建该类型的私有静态实例</span><br><span class="line">	private static SingletonOne instance=new SingletonOne();</span><br><span class="line"></span><br><span class="line">	//3、创建公有静态方法返回静态实例对象</span><br><span class="line">	public static SingletonOne getInstance()&#123;</span><br><span class="line">		return instance;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>lazy: instantiate when using; not thread-safe  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    //懒汉式：类内实例对象创建时并不直接初始化，直到第一次调用get方法时，才完成初始化操作</span><br><span class="line">//时间换空间</span><br><span class="line">public class SingletonTwo &#123;</span><br><span class="line">	//1、创建私有构造方法</span><br><span class="line">	private SingletonTwo()&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	//2、创建静态的该类实例对象</span><br><span class="line">	private static SingletonTwo instance=null;</span><br><span class="line"></span><br><span class="line">	//3、创建开放的静态方法提供实例对象</span><br><span class="line">	public static SingletonTwo getInstance()&#123;</span><br><span class="line">		if(instance==null)</span><br><span class="line">			instance=new SingletonTwo();</span><br><span class="line"></span><br><span class="line">		return instance;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>同步锁</li>
<li>双重校验锁</li>
<li>静态内部类</li>
<li>枚举</li>
</ul>
</li>
</ul>
</li>
<li>pro<ul>
<li>save memory</li>
<li>avoid frequent creating</li>
</ul>
</li>
<li>con<ul>
<li>hard to extend</li>
<li>if not used for a long time, lost due to GC</li>
</ul>
</li>
<li>when to use<ul>
<li>save memory</li>
<li>universal handling</li>
<li>multiple instances will cause problems, e.g. order number generator</li>
</ul>
</li>
</ul>
<h2 id="Coding-Standards"><a href="#Coding-Standards" class="headerlink" title="Coding Standards"></a>Coding Standards</h2><ul>
<li>reference: 《重构》《代码大全》《代码简洁之道》</li>
</ul>
<h2 id="Refactoring"><a href="#Refactoring" class="headerlink" title="Refactoring"></a>Refactoring</h2><ul>
<li>why, what, when, how</li>
<li>unit test, testability</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/03/26/OOD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/26/OOD/" class="post-title-link" itemprop="url">OOD</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-26 13:13:23 / Modified: 13:19:21" itemprop="dateCreated datePublished" datetime="2022-03-26T13:13:23-04:00">2022-03-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OOD/" itemprop="url" rel="index"><span itemprop="name">OOD</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="three-features"><a href="#three-features" class="headerlink" title="three features"></a>three features</h2><ul>
<li>encapsulation: private attribute, getter and setter</li>
<li>inheritance:<ul>
<li>has all attributes and methods of the base class, but cannot access the private members of the base class</li>
<li>can have its own members</li>
<li>can override methods of base class</li>
</ul>
</li>
<li>poly: 所谓多态就是指程序中定义的引用变量所指向的具体类型和通过该引用变量发出的方法调用在编<br>程时并不确定，而是在程序运行期间才确定，即一个引用变量到底会指向哪个类的实例对象，该<br>引用变量发出的方法调用到底是哪个类中实现的方法，必须在由程序运行期间才能决定。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/03/25/Project-SpringBoot-E-commerce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/25/Project-SpringBoot-E-commerce/" class="post-title-link" itemprop="url">Project: SpringBoot E-commerce</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-25 21:58:28 / Modified: 22:18:21" itemprop="dateCreated datePublished" datetime="2022-03-25T21:58:28-04:00">2022-03-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h2><ul>
<li>User</li>
<li>Product</li>
<li>Category</li>
<li>Cart</li>
</ul>
<h3 id="User"><a href="#User" class="headerlink" title="User"></a>User</h3><ul>
<li>Log-in</li>
<li>Log-out</li>
<li>Register</li>
<li>Duplicate name check</li>
<li>Password encrypted storage</li>
<li>Session<ul>
<li>to remember log-in status, save user information in session</li>
</ul>
</li>
<li>Access control</li>
<li>Unified response object</li>
<li>lomlock</li>
<li>Exception enum</li>
<li>Postman</li>
<li>Unified exception handler</li>
<li>Update personal info</li>
</ul>
<h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><h4 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h4><ul>
<li>Unified response object</li>
<li>Remembering log-in status</li>
<li>Unified exception handler</li>
</ul>
<h3 id="Product"><a href="#Product" class="headerlink" title="Product"></a>Product</h3><ul>
<li></li>
</ul>
<h4 id="Highlight"><a href="#Highlight" class="headerlink" title="Highlight"></a>Highlight</h4><ul>
<li>UUID: Universally Unique Identifier</li>
<li>MyBatis PageHelper<h4 id="Challenge-1"><a href="#Challenge-1" class="headerlink" title="Challenge"></a>Challenge</h4></li>
<li>search and sort products and query a product by category</li>
</ul>
<h3 id="Category"><a href="#Category" class="headerlink" title="Category"></a>Category</h3><ul>
<li>set category</li>
<li>associate a product to a category<h4 id="Challenge-2"><a href="#Challenge-2" class="headerlink" title="Challenge"></a>Challenge</h4></li>
<li>Swagger</li>
<li>Parameter check</li>
<li>Redis integration</li>
<li>Debug using log</li>
</ul>
<h4 id="Why-use-three-levels"><a href="#Why-use-three-levels" class="headerlink" title="Why use three levels?"></a>Why use three levels?</h4><ul>
<li>To deep, hard to find and manage</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/03/25/Distributed-Transaction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/25/Distributed-Transaction/" class="post-title-link" itemprop="url">Distributed Transaction</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-25 19:56:36 / Modified: 20:55:42" itemprop="dateCreated datePublished" datetime="2022-03-25T19:56:36-04:00">2022-03-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Transaction"><a href="#Transaction" class="headerlink" title="Transaction"></a>Transaction</h2><p>a programming execution unit to manipulate data in the databases</p>
<ul>
<li>Atomic: all succeed or all fail</li>
<li>Consistency: does not change the data integrity of database. ?</li>
<li>Isolation: not disturb other transactions</li>
<li>Durability: permanently change</li>
</ul>
<h3 id="Isolation"><a href="#Isolation" class="headerlink" title="Isolation"></a>Isolation</h3><ul>
<li>Read uncommitted</li>
<li>Read committed: ?</li>
<li>Repeatable read: ?</li>
<li>Serializable: ?</li>
</ul>
<h2 id="How-to-ensure-ACID"><a href="#How-to-ensure-ACID" class="headerlink" title="How to ensure ACID"></a>How to ensure ACID</h2><p>InnoDB:</p>
<ul>
<li>A: Undo log</li>
<li>C: Undo log</li>
<li>I: lock</li>
<li>D: Redo log</li>
</ul>
<h3 id="Undo-log"><a href="#Undo-log" class="headerlink" title="Undo log"></a>Undo log</h3><p>record data before manipulation in undo log, rollback</p>
<h3 id="Redo-log"><a href="#Redo-log" class="headerlink" title="Redo log"></a>Redo log</h3><p>record new data in redo log</p>
<h3 id="Issues"><a href="#Issues" class="headerlink" title="Issues"></a>Issues</h3><h2 id="Dirty-Read"><a href="#Dirty-Read" class="headerlink" title="Dirty Read"></a>Dirty Read</h2><h2 id="Phantom-Read"><a href="#Phantom-Read" class="headerlink" title="Phantom Read"></a>Phantom Read</h2><h2 id="Unrepeatable-Read"><a href="#Unrepeatable-Read" class="headerlink" title="Unrepeatable Read"></a>Unrepeatable Read</h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><ul>
<li>Make sure data consistent in sub-system.</li>
<li>A big operation consists of small operations on many nodes. Make sure all succeed or fail.</li>
<li>Example: Create order and decrement stock count. All succeed or fail.</li>
</ul>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><ul>
<li>Multiple databases</li>
<li>Sharding</li>
<li>Microservices</li>
</ul>
<h2 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h2><ul>
<li>Consistency: all nodes see the same data at the same time.</li>
<li>Availability: return normal result (success or failure) within reasonable time</li>
<li>Partition tolerance: ?<br>CP or AP<br>Money: CP<br>Internet: AP</li>
</ul>
<h3 id="Consistency"><a href="#Consistency" class="headerlink" title="Consistency"></a>Consistency</h3><ul>
<li>Strong: The data in all nodes is the same at any time</li>
<li>Weak: ?</li>
<li>Eventual: ?</li>
</ul>
<h2 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h2><p>For AP<br>Eventual instead of strong consistency</p>
<ul>
<li>Basically available: some available: longer response time; lose some functions</li>
<li>Soft state: allow middle state, 即允许系统在不同节点的数据副本之间进⾏数据同步的过程存在延时</li>
<li>Eventually consistent: ?</li>
</ul>
<h3 id="BASE-vs-ACID"><a href="#BASE-vs-ACID" class="headerlink" title="BASE vs ACID"></a>BASE vs ACID</h3><ul>
<li>ACID: strong consistency</li>
<li>BASE: sacrifice consistency for availability</li>
</ul>
<h2 id="How-to-solve-the-consistency-problem"><a href="#How-to-solve-the-consistency-problem" class="headerlink" title="How to solve the consistency problem"></a>How to solve the consistency problem</h2><ul>
<li>avoid distribution</li>
<li>distributed transaction</li>
</ul>
<h2 id="Distributed-Transaction-Type"><a href="#Distributed-Transaction-Type" class="headerlink" title="Distributed Transaction Type"></a>Distributed Transaction Type</h2><ul>
<li>Hard transaction: CP. Suitable for low concurrency and short transaction</li>
<li>Soft transaction: BASE.</li>
</ul>
<h3 id="Hard-transaction"><a href="#Hard-transaction" class="headerlink" title="Hard transaction"></a>Hard transaction</h3><ul>
<li>XA: 2PC, JTA, JTS; 3PC; due to synchronous blocking, low efficiency.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://liamyaolian.github.io/2022/03/25/ORM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Liam Lian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam Lian's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/03/25/ORM/" class="post-title-link" itemprop="url">ORM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-03-25 19:06:05 / Modified: 19:13:58" itemprop="dateCreated datePublished" datetime="2022-03-25T19:06:05-04:00">2022-03-25</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/framework-fundamental/" itemprop="url" rel="index"><span itemprop="name">framework fundamental</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><ul>
<li>table -&gt; class</li>
<li>record -&gt; object</li>
<li>field -&gt; attribute</li>
</ul>
<h2 id="Pros"><a href="#Pros" class="headerlink" title="Pros"></a>Pros</h2><ul>
<li>use MVC as architecture</li>
<li>automation</li>
<li>more flexibility for programming</li>
</ul>
<h2 id="Cons"><a href="#Cons" class="headerlink" title="Cons"></a>Cons</h2><ul>
<li>need time to config</li>
<li>as to complex queries, hard to write or will have worse performance than SQL</li>
<li>hide the details about how to manipulate databases</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Liam Lian</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liam Lian</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
